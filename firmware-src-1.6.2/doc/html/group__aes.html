<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <title>Make Controller Kit - Firmware API: AES (Advanced Encryption Standard)</title>
  <link href="mt_doxygen.css" rel="stylesheet" type="text/css" />
  <link href="../resources/mt_doxytabs.css" rel="stylesheet" type="text/css" />
</head>

<body>
  <div id="header">
    <a href="http://www.makingthings.com">
      <img src="../resources/logo.png" alt="MakingThings" border="0"/>
    </a>
    <form id='searchbox' method="get" action="http://www.google.com/search">
      <div align="right">
        <input type="text"   name="q" size="25" maxlength="255" value="" />
        <input type="submit" value="Search" />
        <input type="hidden" name="sitesearch" value="makingthings.com/ref/firmware/html" />
      </div>
    </form>
  </div>

<!-- Generated by Doxygen 1.5.8 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>AES (Advanced Encryption Standard)<br>
<small>
[<a class="el" href="group___libraries.html">Libraries</a>]</small>
</h1>Encrypt and decrypt data using AES.  
<a href="#_details">More...</a>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__aes.html#g8a6a56c97a2aba6b19962abf330ea266">Aes_Encrypt</a> (unsigned char *output, int outlen, unsigned char *input, int inlen, unsigned char *password)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Ecrypt a block of data using AES.  <a href="#g8a6a56c97a2aba6b19962abf330ea266"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__aes.html#g5c03c43f883600bc5877e9b50c54438a">Aes_Decrypt</a> (unsigned char *output, int outlen, unsigned char *input, int inlen, unsigned char *password)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Decrypt a block of AES encrypted data.  <a href="#g5c03c43f883600bc5877e9b50c54438a"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Encrypt and decrypt data using AES. 
<p>
AES is a block cipher adopted for use by the NSA (US government agency). According to Wikipedia, "This marks the first time the public has had access to a cipher approved by the NSA for top secret information." Pretty cool, right? This is a good way to send info privately from your Make Controller over the network, to a web server for example.<p>
AES requires that both sides of communication have access to the same key. So both your Make Controller, and whatever other device it's communicating with need to know about the same password so they can decrypt data that has been encrypted by the other.<p>
There are several different flavors of AES. There are two main ways in which AES libraries differ:<ul>
<li>the way they chain blocks</li><li>the way they pad data</li></ul>
<p>
This library uses ECB (Electronic Code Book) chaining, and pads data with a character that corresponds to the number of bytes needed to pad to 16. Check the Wikipedia article for an explanation - <a href="http://en.wikipedia.org/wiki/Advanced_Encryption_Standard">http://en.wikipedia.org/wiki/Advanced_Encryption_Standard</a><p>
The lookup tables used in this library will use somewhere between 8 and 13 kB of program space, depending on the compiler optimization you use. Memory usage is pretty minimal.<p>
Code is used and adapted from Philip J. Erdelsky - see <a href="http://www.efgh.com/software/rijndael.htm">http://www.efgh.com/software/rijndael.htm</a> for the original. <hr><h2>Function Documentation</h2>
<a class="anchor" name="g5c03c43f883600bc5877e9b50c54438a"></a><!-- doxytag: member="aes.c::Aes_Decrypt" ref="g5c03c43f883600bc5877e9b50c54438a" args="(unsigned char *output, int outlen, unsigned char *input, int inlen, unsigned char *password)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Aes_Decrypt           </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>password</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Decrypt a block of AES encrypted data. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>output</em>&nbsp;</td><td>A pointer to the buffer into which the decrypted data will be written. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outlen</em>&nbsp;</td><td>The maximum number of bytes of data to write into the output buffer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>A pointer to the encrypted block to be decrytped. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>inlen</em>&nbsp;</td><td>The number of bytes to be decrypted. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>password</em>&nbsp;</td><td>The password, or key, used to encrypt the data. Must be 16 bytes long. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The number of bytes written, or -1 on failure.</dd></dl>
<dl class="user" compact><dt><b>Example</b></dt><dd><div class="fragment"><pre class="fragment">  <span class="comment">// first encrypt some data, then decrypt it and make sure we get out what we put in</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cipherbuf[256];
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> plainbuf[256];
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> plaintext[] = <span class="stringliteral">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>; <span class="comment">// our plaintext to encrypt</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> secret[] = <span class="stringliteral">"A SECRET PASSWORD"</span>; <span class="comment">// 16 bytes long</span>

  <span class="keywordtype">int</span> written = <a class="code" href="group__aes.html#g8a6a56c97a2aba6b19962abf330ea266" title="Ecrypt a block of data using AES.">Aes_Encrypt</a>(cipherbuf, 256, plaintext, 26, secret);
  written = <a class="code" href="group__aes.html#g5c03c43f883600bc5877e9b50c54438a" title="Decrypt a block of AES encrypted data.">Aes_Decrypt</a>(plainbuf, 256, cipherbuf, written, secret);
  <span class="comment">// we now have our original plaintext in plainbuf</span>
</pre></div> </dd></dl>

<p>Definition at line <a class="el" href="aes_8c-source.html#l01373">1373</a> of file <a class="el" href="aes_8c-source.html">aes.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="g8a6a56c97a2aba6b19962abf330ea266"></a><!-- doxytag: member="aes.c::Aes_Encrypt" ref="g8a6a56c97a2aba6b19962abf330ea266" args="(unsigned char *output, int outlen, unsigned char *input, int inlen, unsigned char *password)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Aes_Encrypt           </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>password</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Ecrypt a block of data using AES. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>output</em>&nbsp;</td><td>A pointer to the buffer into which the encrypted data will be written. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outlen</em>&nbsp;</td><td>The maximum number of bytes to write into the output buffer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>A pointer to the data to be encrypted. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>inlen</em>&nbsp;</td><td>The number of bytes of data to encrypt. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>password</em>&nbsp;</td><td>The password, or key, used to encrypt the data. Must be 16 bytes long. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The number of bytes encrypted, or -1 on failure.</dd></dl>
<dl class="user" compact><dt><b>Example</b></dt><dd><div class="fragment"><pre class="fragment"><span class="preprocessor">  #define BUFF_SIZE 256</span>
<span class="preprocessor"></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cipherbuf[BUFF_SIZE]; <span class="comment">// the buffer that will be written into</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> plaintext[] = <span class="stringliteral">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>; <span class="comment">// the text to encrypt</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> secret[] = <span class="stringliteral">"A SECRET PASSWORD"</span>; <span class="comment">// 16 bytes long</span>
  <span class="keywordtype">int</span> written = <a class="code" href="group__aes.html#g8a6a56c97a2aba6b19962abf330ea266" title="Ecrypt a block of data using AES.">Aes_Encrypt</a>(cipherbuf, BUFF_SIZE, plaintext, 26, secret);
</pre></div> </dd></dl>

<p>Definition at line <a class="el" href="aes_8c-source.html#l01298">1298</a> of file <a class="el" href="aes_8c-source.html">aes.c</a>.</p>

</div>
</div><p>
</div>

<hr size="1">
<div>
  <p id="footer">The Make Controller Kit is an open source project maintained by <a href="http://www.makingthings.com">MakingThings</a>.<br />
    MakingThings code is released under the <a href="http://www.apache.org/licenses/LICENSE-2.0.html" target="_blank">Apache 2.0 license</a>.<br />
    Bug tracker, development wiki and status can be found at <a href="http://dev.makingthings.com">http://dev.makingthings.com</a>.<br />
    This document was last updated on 18 May 2009.
  </p>
</div>
<!-- Google Analytics Code -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
_uacct = "UA-769030-1";
urchinTracker();
</script>
</body>
</html>
