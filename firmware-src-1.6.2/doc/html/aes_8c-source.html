<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <title>Make Controller Kit - Firmware API: aes.c Source File</title>
  <link href="mt_doxygen.css" rel="stylesheet" type="text/css" />
  <link href="../resources/mt_doxytabs.css" rel="stylesheet" type="text/css" />
</head>

<body>
  <div id="header">
    <a href="http://www.makingthings.com">
      <img src="../resources/logo.png" alt="MakingThings" border="0"/>
    </a>
    <form id='searchbox' method="get" action="http://www.google.com/search">
      <div align="right">
        <input type="text"   name="q" size="25" maxlength="255" value="" />
        <input type="submit" value="Search" />
        <input type="hidden" name="sitesearch" value="makingthings.com/ref/firmware/html" />
      </div>
    </form>
  </div>

<!-- Generated by Doxygen 1.5.8 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>aes.c</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*********************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment"> Copyright 2006-2008 MakingThings</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment"> Licensed under the Apache License, </span>
<a name="l00006"></a>00006 <span class="comment"> Version 2.0 (the "License"); you may not use this file except in compliance </span>
<a name="l00007"></a>00007 <span class="comment"> with the License. You may obtain a copy of the License at</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment"> http://www.apache.org/licenses/LICENSE-2.0 </span>
<a name="l00010"></a>00010 <span class="comment"> </span>
<a name="l00011"></a>00011 <span class="comment"> Unless required by applicable law or agreed to in writing, software distributed</span>
<a name="l00012"></a>00012 <span class="comment"> under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR</span>
<a name="l00013"></a>00013 <span class="comment"> CONDITIONS OF ANY KIND, either express or implied. See the License for</span>
<a name="l00014"></a>00014 <span class="comment"> the specific language governing permissions and limitations under the License.</span>
<a name="l00015"></a>00015 <span class="comment"></span>
<a name="l00016"></a>00016 <span class="comment">*********************************************************************************/</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor">#include "aes.h"</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 <span class="keyword">static</span> <span class="keywordtype">int</span> Aes_SetupEncrypt( <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>* rk, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* key, <span class="keywordtype">int</span> keybits);
<a name="l00022"></a>00022 <span class="keyword">static</span> <span class="keywordtype">int</span> Aes_SetupDecrypt( <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *rk, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *key, <span class="keywordtype">int</span> keybits);
<a name="l00023"></a>00023 <span class="keyword">static</span> <span class="keywordtype">void</span> Aes_DoEncrypt( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *rk, <span class="keywordtype">int</span> nrounds, 
<a name="l00024"></a>00024   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> plaintext[16], <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ciphertext[16]);
<a name="l00025"></a>00025 <span class="keyword">static</span> <span class="keywordtype">void</span> Aes_DoDecrypt( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *rk, <span class="keywordtype">int</span> nrounds,
<a name="l00026"></a>00026   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ciphertext[16], <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> plaintext[16]);
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="preprocessor">#define FULL_UNROLL</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span>
<a name="l00030"></a>00030 <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> u32;
<a name="l00031"></a>00031 <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> u8;
<a name="l00032"></a>00032 <span class="comment"></span>
<a name="l00033"></a>00033 <span class="comment">/** \defgroup aes AES (Advanced Encryption Standard)</span>
<a name="l00034"></a>00034 <span class="comment">  Encrypt and decrypt data using AES.</span>
<a name="l00035"></a>00035 <span class="comment"></span>
<a name="l00036"></a>00036 <span class="comment">  AES is a block cipher adopted for use by the NSA (US government agency).  According to Wikipedia,</span>
<a name="l00037"></a>00037 <span class="comment">  "This marks the first time the public has had access to a cipher approved by the NSA for</span>
<a name="l00038"></a>00038 <span class="comment">  top secret information."  Pretty cool, right?  This is a good way to send info privately</span>
<a name="l00039"></a>00039 <span class="comment">  from your Make Controller over the network, to a web server for example.</span>
<a name="l00040"></a>00040 <span class="comment"></span>
<a name="l00041"></a>00041 <span class="comment">  AES requires that both sides of communication have access to the same key.  So both your Make </span>
<a name="l00042"></a>00042 <span class="comment">  Controller, and whatever other device it's communicating with need to know about the same </span>
<a name="l00043"></a>00043 <span class="comment">  password so they can decrypt data that has been encrypted by the other.</span>
<a name="l00044"></a>00044 <span class="comment"></span>
<a name="l00045"></a>00045 <span class="comment">  There are several different flavors of AES.  There are two main ways in which AES libraries</span>
<a name="l00046"></a>00046 <span class="comment">  differ:</span>
<a name="l00047"></a>00047 <span class="comment">  - the way they chain blocks</span>
<a name="l00048"></a>00048 <span class="comment">  - the way they pad data</span>
<a name="l00049"></a>00049 <span class="comment"></span>
<a name="l00050"></a>00050 <span class="comment">  This library uses ECB (Electronic Code Book) chaining, and pads data with a character </span>
<a name="l00051"></a>00051 <span class="comment">  that corresponds to the number of bytes needed to pad to 16.  Check the Wikipedia article</span>
<a name="l00052"></a>00052 <span class="comment">  for an explanation - http://en.wikipedia.org/wiki/Advanced_Encryption_Standard</span>
<a name="l00053"></a>00053 <span class="comment"></span>
<a name="l00054"></a>00054 <span class="comment">  The lookup tables used in this library will use somewhere between 8 and 13 kB of program space, </span>
<a name="l00055"></a>00055 <span class="comment">  depending on the compiler optimization you use.  Memory usage is pretty minimal.</span>
<a name="l00056"></a>00056 <span class="comment"></span>
<a name="l00057"></a>00057 <span class="comment">  Code is used and adapted from Philip J. Erdelsky - see http://www.efgh.com/software/rijndael.htm</span>
<a name="l00058"></a>00058 <span class="comment">  for the original.</span>
<a name="l00059"></a>00059 <span class="comment"></span>
<a name="l00060"></a>00060 <span class="comment">  \ingroup Libraries</span>
<a name="l00061"></a>00061 <span class="comment">  @{</span>
<a name="l00062"></a>00062 <span class="comment">*/</span>
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 <span class="keyword">static</span> <span class="keyword">const</span> u32 Te0[256] =
<a name="l00065"></a>00065 {
<a name="l00066"></a>00066   0xc66363a5U, 0xf87c7c84U, 0xee777799U, 0xf67b7b8dU,
<a name="l00067"></a>00067   0xfff2f20dU, 0xd66b6bbdU, 0xde6f6fb1U, 0x91c5c554U,
<a name="l00068"></a>00068   0x60303050U, 0x02010103U, 0xce6767a9U, 0x562b2b7dU,
<a name="l00069"></a>00069   0xe7fefe19U, 0xb5d7d762U, 0x4dababe6U, 0xec76769aU,
<a name="l00070"></a>00070   0x8fcaca45U, 0x1f82829dU, 0x89c9c940U, 0xfa7d7d87U,
<a name="l00071"></a>00071   0xeffafa15U, 0xb25959ebU, 0x8e4747c9U, 0xfbf0f00bU,
<a name="l00072"></a>00072   0x41adadecU, 0xb3d4d467U, 0x5fa2a2fdU, 0x45afafeaU,
<a name="l00073"></a>00073   0x239c9cbfU, 0x53a4a4f7U, 0xe4727296U, 0x9bc0c05bU,
<a name="l00074"></a>00074   0x75b7b7c2U, 0xe1fdfd1cU, 0x3d9393aeU, 0x4c26266aU,
<a name="l00075"></a>00075   0x6c36365aU, 0x7e3f3f41U, 0xf5f7f702U, 0x83cccc4fU,
<a name="l00076"></a>00076   0x6834345cU, 0x51a5a5f4U, 0xd1e5e534U, 0xf9f1f108U,
<a name="l00077"></a>00077   0xe2717193U, 0xabd8d873U, 0x62313153U, 0x2a15153fU,
<a name="l00078"></a>00078   0x0804040cU, 0x95c7c752U, 0x46232365U, 0x9dc3c35eU,
<a name="l00079"></a>00079   0x30181828U, 0x379696a1U, 0x0a05050fU, 0x2f9a9ab5U,
<a name="l00080"></a>00080   0x0e070709U, 0x24121236U, 0x1b80809bU, 0xdfe2e23dU,
<a name="l00081"></a>00081   0xcdebeb26U, 0x4e272769U, 0x7fb2b2cdU, 0xea75759fU,
<a name="l00082"></a>00082   0x1209091bU, 0x1d83839eU, 0x582c2c74U, 0x341a1a2eU,
<a name="l00083"></a>00083   0x361b1b2dU, 0xdc6e6eb2U, 0xb45a5aeeU, 0x5ba0a0fbU,
<a name="l00084"></a>00084   0xa45252f6U, 0x763b3b4dU, 0xb7d6d661U, 0x7db3b3ceU,
<a name="l00085"></a>00085   0x5229297bU, 0xdde3e33eU, 0x5e2f2f71U, 0x13848497U,
<a name="l00086"></a>00086   0xa65353f5U, 0xb9d1d168U, 0x00000000U, 0xc1eded2cU,
<a name="l00087"></a>00087   0x40202060U, 0xe3fcfc1fU, 0x79b1b1c8U, 0xb65b5bedU,
<a name="l00088"></a>00088   0xd46a6abeU, 0x8dcbcb46U, 0x67bebed9U, 0x7239394bU,
<a name="l00089"></a>00089   0x944a4adeU, 0x984c4cd4U, 0xb05858e8U, 0x85cfcf4aU,
<a name="l00090"></a>00090   0xbbd0d06bU, 0xc5efef2aU, 0x4faaaae5U, 0xedfbfb16U,
<a name="l00091"></a>00091   0x864343c5U, 0x9a4d4dd7U, 0x66333355U, 0x11858594U,
<a name="l00092"></a>00092   0x8a4545cfU, 0xe9f9f910U, 0x04020206U, 0xfe7f7f81U,
<a name="l00093"></a>00093   0xa05050f0U, 0x783c3c44U, 0x259f9fbaU, 0x4ba8a8e3U,
<a name="l00094"></a>00094   0xa25151f3U, 0x5da3a3feU, 0x804040c0U, 0x058f8f8aU,
<a name="l00095"></a>00095   0x3f9292adU, 0x219d9dbcU, 0x70383848U, 0xf1f5f504U,
<a name="l00096"></a>00096   0x63bcbcdfU, 0x77b6b6c1U, 0xafdada75U, 0x42212163U,
<a name="l00097"></a>00097   0x20101030U, 0xe5ffff1aU, 0xfdf3f30eU, 0xbfd2d26dU,
<a name="l00098"></a>00098   0x81cdcd4cU, 0x180c0c14U, 0x26131335U, 0xc3ecec2fU,
<a name="l00099"></a>00099   0xbe5f5fe1U, 0x359797a2U, 0x884444ccU, 0x2e171739U,
<a name="l00100"></a>00100   0x93c4c457U, 0x55a7a7f2U, 0xfc7e7e82U, 0x7a3d3d47U,
<a name="l00101"></a>00101   0xc86464acU, 0xba5d5de7U, 0x3219192bU, 0xe6737395U,
<a name="l00102"></a>00102   0xc06060a0U, 0x19818198U, 0x9e4f4fd1U, 0xa3dcdc7fU,
<a name="l00103"></a>00103   0x44222266U, 0x542a2a7eU, 0x3b9090abU, 0x0b888883U,
<a name="l00104"></a>00104   0x8c4646caU, 0xc7eeee29U, 0x6bb8b8d3U, 0x2814143cU,
<a name="l00105"></a>00105   0xa7dede79U, 0xbc5e5ee2U, 0x160b0b1dU, 0xaddbdb76U,
<a name="l00106"></a>00106   0xdbe0e03bU, 0x64323256U, 0x743a3a4eU, 0x140a0a1eU,
<a name="l00107"></a>00107   0x924949dbU, 0x0c06060aU, 0x4824246cU, 0xb85c5ce4U,
<a name="l00108"></a>00108   0x9fc2c25dU, 0xbdd3d36eU, 0x43acacefU, 0xc46262a6U,
<a name="l00109"></a>00109   0x399191a8U, 0x319595a4U, 0xd3e4e437U, 0xf279798bU,
<a name="l00110"></a>00110   0xd5e7e732U, 0x8bc8c843U, 0x6e373759U, 0xda6d6db7U,
<a name="l00111"></a>00111   0x018d8d8cU, 0xb1d5d564U, 0x9c4e4ed2U, 0x49a9a9e0U,
<a name="l00112"></a>00112   0xd86c6cb4U, 0xac5656faU, 0xf3f4f407U, 0xcfeaea25U,
<a name="l00113"></a>00113   0xca6565afU, 0xf47a7a8eU, 0x47aeaee9U, 0x10080818U,
<a name="l00114"></a>00114   0x6fbabad5U, 0xf0787888U, 0x4a25256fU, 0x5c2e2e72U,
<a name="l00115"></a>00115   0x381c1c24U, 0x57a6a6f1U, 0x73b4b4c7U, 0x97c6c651U,
<a name="l00116"></a>00116   0xcbe8e823U, 0xa1dddd7cU, 0xe874749cU, 0x3e1f1f21U,
<a name="l00117"></a>00117   0x964b4bddU, 0x61bdbddcU, 0x0d8b8b86U, 0x0f8a8a85U,
<a name="l00118"></a>00118   0xe0707090U, 0x7c3e3e42U, 0x71b5b5c4U, 0xcc6666aaU,
<a name="l00119"></a>00119   0x904848d8U, 0x06030305U, 0xf7f6f601U, 0x1c0e0e12U,
<a name="l00120"></a>00120   0xc26161a3U, 0x6a35355fU, 0xae5757f9U, 0x69b9b9d0U,
<a name="l00121"></a>00121   0x17868691U, 0x99c1c158U, 0x3a1d1d27U, 0x279e9eb9U,
<a name="l00122"></a>00122   0xd9e1e138U, 0xebf8f813U, 0x2b9898b3U, 0x22111133U,
<a name="l00123"></a>00123   0xd26969bbU, 0xa9d9d970U, 0x078e8e89U, 0x339494a7U,
<a name="l00124"></a>00124   0x2d9b9bb6U, 0x3c1e1e22U, 0x15878792U, 0xc9e9e920U,
<a name="l00125"></a>00125   0x87cece49U, 0xaa5555ffU, 0x50282878U, 0xa5dfdf7aU,
<a name="l00126"></a>00126   0x038c8c8fU, 0x59a1a1f8U, 0x09898980U, 0x1a0d0d17U,
<a name="l00127"></a>00127   0x65bfbfdaU, 0xd7e6e631U, 0x844242c6U, 0xd06868b8U,
<a name="l00128"></a>00128   0x824141c3U, 0x299999b0U, 0x5a2d2d77U, 0x1e0f0f11U,
<a name="l00129"></a>00129   0x7bb0b0cbU, 0xa85454fcU, 0x6dbbbbd6U, 0x2c16163aU,
<a name="l00130"></a>00130 };
<a name="l00131"></a>00131 
<a name="l00132"></a>00132 <span class="keyword">static</span> <span class="keyword">const</span> u32 Te1[256] =
<a name="l00133"></a>00133 {
<a name="l00134"></a>00134   0xa5c66363U, 0x84f87c7cU, 0x99ee7777U, 0x8df67b7bU,
<a name="l00135"></a>00135   0x0dfff2f2U, 0xbdd66b6bU, 0xb1de6f6fU, 0x5491c5c5U,
<a name="l00136"></a>00136   0x50603030U, 0x03020101U, 0xa9ce6767U, 0x7d562b2bU,
<a name="l00137"></a>00137   0x19e7fefeU, 0x62b5d7d7U, 0xe64dababU, 0x9aec7676U,
<a name="l00138"></a>00138   0x458fcacaU, 0x9d1f8282U, 0x4089c9c9U, 0x87fa7d7dU,
<a name="l00139"></a>00139   0x15effafaU, 0xebb25959U, 0xc98e4747U, 0x0bfbf0f0U,
<a name="l00140"></a>00140   0xec41adadU, 0x67b3d4d4U, 0xfd5fa2a2U, 0xea45afafU,
<a name="l00141"></a>00141   0xbf239c9cU, 0xf753a4a4U, 0x96e47272U, 0x5b9bc0c0U,
<a name="l00142"></a>00142   0xc275b7b7U, 0x1ce1fdfdU, 0xae3d9393U, 0x6a4c2626U,
<a name="l00143"></a>00143   0x5a6c3636U, 0x417e3f3fU, 0x02f5f7f7U, 0x4f83ccccU,
<a name="l00144"></a>00144   0x5c683434U, 0xf451a5a5U, 0x34d1e5e5U, 0x08f9f1f1U,
<a name="l00145"></a>00145   0x93e27171U, 0x73abd8d8U, 0x53623131U, 0x3f2a1515U,
<a name="l00146"></a>00146   0x0c080404U, 0x5295c7c7U, 0x65462323U, 0x5e9dc3c3U,
<a name="l00147"></a>00147   0x28301818U, 0xa1379696U, 0x0f0a0505U, 0xb52f9a9aU,
<a name="l00148"></a>00148   0x090e0707U, 0x36241212U, 0x9b1b8080U, 0x3ddfe2e2U,
<a name="l00149"></a>00149   0x26cdebebU, 0x694e2727U, 0xcd7fb2b2U, 0x9fea7575U,
<a name="l00150"></a>00150   0x1b120909U, 0x9e1d8383U, 0x74582c2cU, 0x2e341a1aU,
<a name="l00151"></a>00151   0x2d361b1bU, 0xb2dc6e6eU, 0xeeb45a5aU, 0xfb5ba0a0U,
<a name="l00152"></a>00152   0xf6a45252U, 0x4d763b3bU, 0x61b7d6d6U, 0xce7db3b3U,
<a name="l00153"></a>00153   0x7b522929U, 0x3edde3e3U, 0x715e2f2fU, 0x97138484U,
<a name="l00154"></a>00154   0xf5a65353U, 0x68b9d1d1U, 0x00000000U, 0x2cc1ededU,
<a name="l00155"></a>00155   0x60402020U, 0x1fe3fcfcU, 0xc879b1b1U, 0xedb65b5bU,
<a name="l00156"></a>00156   0xbed46a6aU, 0x468dcbcbU, 0xd967bebeU, 0x4b723939U,
<a name="l00157"></a>00157   0xde944a4aU, 0xd4984c4cU, 0xe8b05858U, 0x4a85cfcfU,
<a name="l00158"></a>00158   0x6bbbd0d0U, 0x2ac5efefU, 0xe54faaaaU, 0x16edfbfbU,
<a name="l00159"></a>00159   0xc5864343U, 0xd79a4d4dU, 0x55663333U, 0x94118585U,
<a name="l00160"></a>00160   0xcf8a4545U, 0x10e9f9f9U, 0x06040202U, 0x81fe7f7fU,
<a name="l00161"></a>00161   0xf0a05050U, 0x44783c3cU, 0xba259f9fU, 0xe34ba8a8U,
<a name="l00162"></a>00162   0xf3a25151U, 0xfe5da3a3U, 0xc0804040U, 0x8a058f8fU,
<a name="l00163"></a>00163   0xad3f9292U, 0xbc219d9dU, 0x48703838U, 0x04f1f5f5U,
<a name="l00164"></a>00164   0xdf63bcbcU, 0xc177b6b6U, 0x75afdadaU, 0x63422121U,
<a name="l00165"></a>00165   0x30201010U, 0x1ae5ffffU, 0x0efdf3f3U, 0x6dbfd2d2U,
<a name="l00166"></a>00166   0x4c81cdcdU, 0x14180c0cU, 0x35261313U, 0x2fc3ececU,
<a name="l00167"></a>00167   0xe1be5f5fU, 0xa2359797U, 0xcc884444U, 0x392e1717U,
<a name="l00168"></a>00168   0x5793c4c4U, 0xf255a7a7U, 0x82fc7e7eU, 0x477a3d3dU,
<a name="l00169"></a>00169   0xacc86464U, 0xe7ba5d5dU, 0x2b321919U, 0x95e67373U,
<a name="l00170"></a>00170   0xa0c06060U, 0x98198181U, 0xd19e4f4fU, 0x7fa3dcdcU,
<a name="l00171"></a>00171   0x66442222U, 0x7e542a2aU, 0xab3b9090U, 0x830b8888U,
<a name="l00172"></a>00172   0xca8c4646U, 0x29c7eeeeU, 0xd36bb8b8U, 0x3c281414U,
<a name="l00173"></a>00173   0x79a7dedeU, 0xe2bc5e5eU, 0x1d160b0bU, 0x76addbdbU,
<a name="l00174"></a>00174   0x3bdbe0e0U, 0x56643232U, 0x4e743a3aU, 0x1e140a0aU,
<a name="l00175"></a>00175   0xdb924949U, 0x0a0c0606U, 0x6c482424U, 0xe4b85c5cU,
<a name="l00176"></a>00176   0x5d9fc2c2U, 0x6ebdd3d3U, 0xef43acacU, 0xa6c46262U,
<a name="l00177"></a>00177   0xa8399191U, 0xa4319595U, 0x37d3e4e4U, 0x8bf27979U,
<a name="l00178"></a>00178   0x32d5e7e7U, 0x438bc8c8U, 0x596e3737U, 0xb7da6d6dU,
<a name="l00179"></a>00179   0x8c018d8dU, 0x64b1d5d5U, 0xd29c4e4eU, 0xe049a9a9U,
<a name="l00180"></a>00180   0xb4d86c6cU, 0xfaac5656U, 0x07f3f4f4U, 0x25cfeaeaU,
<a name="l00181"></a>00181   0xafca6565U, 0x8ef47a7aU, 0xe947aeaeU, 0x18100808U,
<a name="l00182"></a>00182   0xd56fbabaU, 0x88f07878U, 0x6f4a2525U, 0x725c2e2eU,
<a name="l00183"></a>00183   0x24381c1cU, 0xf157a6a6U, 0xc773b4b4U, 0x5197c6c6U,
<a name="l00184"></a>00184   0x23cbe8e8U, 0x7ca1ddddU, 0x9ce87474U, 0x213e1f1fU,
<a name="l00185"></a>00185   0xdd964b4bU, 0xdc61bdbdU, 0x860d8b8bU, 0x850f8a8aU,
<a name="l00186"></a>00186   0x90e07070U, 0x427c3e3eU, 0xc471b5b5U, 0xaacc6666U,
<a name="l00187"></a>00187   0xd8904848U, 0x05060303U, 0x01f7f6f6U, 0x121c0e0eU,
<a name="l00188"></a>00188   0xa3c26161U, 0x5f6a3535U, 0xf9ae5757U, 0xd069b9b9U,
<a name="l00189"></a>00189   0x91178686U, 0x5899c1c1U, 0x273a1d1dU, 0xb9279e9eU,
<a name="l00190"></a>00190   0x38d9e1e1U, 0x13ebf8f8U, 0xb32b9898U, 0x33221111U,
<a name="l00191"></a>00191   0xbbd26969U, 0x70a9d9d9U, 0x89078e8eU, 0xa7339494U,
<a name="l00192"></a>00192   0xb62d9b9bU, 0x223c1e1eU, 0x92158787U, 0x20c9e9e9U,
<a name="l00193"></a>00193   0x4987ceceU, 0xffaa5555U, 0x78502828U, 0x7aa5dfdfU,
<a name="l00194"></a>00194   0x8f038c8cU, 0xf859a1a1U, 0x80098989U, 0x171a0d0dU,
<a name="l00195"></a>00195   0xda65bfbfU, 0x31d7e6e6U, 0xc6844242U, 0xb8d06868U,
<a name="l00196"></a>00196   0xc3824141U, 0xb0299999U, 0x775a2d2dU, 0x111e0f0fU,
<a name="l00197"></a>00197   0xcb7bb0b0U, 0xfca85454U, 0xd66dbbbbU, 0x3a2c1616U,
<a name="l00198"></a>00198 };
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 <span class="keyword">static</span> <span class="keyword">const</span> u32 Te2[256] =
<a name="l00201"></a>00201 {
<a name="l00202"></a>00202   0x63a5c663U, 0x7c84f87cU, 0x7799ee77U, 0x7b8df67bU,
<a name="l00203"></a>00203   0xf20dfff2U, 0x6bbdd66bU, 0x6fb1de6fU, 0xc55491c5U,
<a name="l00204"></a>00204   0x30506030U, 0x01030201U, 0x67a9ce67U, 0x2b7d562bU,
<a name="l00205"></a>00205   0xfe19e7feU, 0xd762b5d7U, 0xabe64dabU, 0x769aec76U,
<a name="l00206"></a>00206   0xca458fcaU, 0x829d1f82U, 0xc94089c9U, 0x7d87fa7dU,
<a name="l00207"></a>00207   0xfa15effaU, 0x59ebb259U, 0x47c98e47U, 0xf00bfbf0U,
<a name="l00208"></a>00208   0xadec41adU, 0xd467b3d4U, 0xa2fd5fa2U, 0xafea45afU,
<a name="l00209"></a>00209   0x9cbf239cU, 0xa4f753a4U, 0x7296e472U, 0xc05b9bc0U,
<a name="l00210"></a>00210   0xb7c275b7U, 0xfd1ce1fdU, 0x93ae3d93U, 0x266a4c26U,
<a name="l00211"></a>00211   0x365a6c36U, 0x3f417e3fU, 0xf702f5f7U, 0xcc4f83ccU,
<a name="l00212"></a>00212   0x345c6834U, 0xa5f451a5U, 0xe534d1e5U, 0xf108f9f1U,
<a name="l00213"></a>00213   0x7193e271U, 0xd873abd8U, 0x31536231U, 0x153f2a15U,
<a name="l00214"></a>00214   0x040c0804U, 0xc75295c7U, 0x23654623U, 0xc35e9dc3U,
<a name="l00215"></a>00215   0x18283018U, 0x96a13796U, 0x050f0a05U, 0x9ab52f9aU,
<a name="l00216"></a>00216   0x07090e07U, 0x12362412U, 0x809b1b80U, 0xe23ddfe2U,
<a name="l00217"></a>00217   0xeb26cdebU, 0x27694e27U, 0xb2cd7fb2U, 0x759fea75U,
<a name="l00218"></a>00218   0x091b1209U, 0x839e1d83U, 0x2c74582cU, 0x1a2e341aU,
<a name="l00219"></a>00219   0x1b2d361bU, 0x6eb2dc6eU, 0x5aeeb45aU, 0xa0fb5ba0U,
<a name="l00220"></a>00220   0x52f6a452U, 0x3b4d763bU, 0xd661b7d6U, 0xb3ce7db3U,
<a name="l00221"></a>00221   0x297b5229U, 0xe33edde3U, 0x2f715e2fU, 0x84971384U,
<a name="l00222"></a>00222   0x53f5a653U, 0xd168b9d1U, 0x00000000U, 0xed2cc1edU,
<a name="l00223"></a>00223   0x20604020U, 0xfc1fe3fcU, 0xb1c879b1U, 0x5bedb65bU,
<a name="l00224"></a>00224   0x6abed46aU, 0xcb468dcbU, 0xbed967beU, 0x394b7239U,
<a name="l00225"></a>00225   0x4ade944aU, 0x4cd4984cU, 0x58e8b058U, 0xcf4a85cfU,
<a name="l00226"></a>00226   0xd06bbbd0U, 0xef2ac5efU, 0xaae54faaU, 0xfb16edfbU,
<a name="l00227"></a>00227   0x43c58643U, 0x4dd79a4dU, 0x33556633U, 0x85941185U,
<a name="l00228"></a>00228   0x45cf8a45U, 0xf910e9f9U, 0x02060402U, 0x7f81fe7fU,
<a name="l00229"></a>00229   0x50f0a050U, 0x3c44783cU, 0x9fba259fU, 0xa8e34ba8U,
<a name="l00230"></a>00230   0x51f3a251U, 0xa3fe5da3U, 0x40c08040U, 0x8f8a058fU,
<a name="l00231"></a>00231   0x92ad3f92U, 0x9dbc219dU, 0x38487038U, 0xf504f1f5U,
<a name="l00232"></a>00232   0xbcdf63bcU, 0xb6c177b6U, 0xda75afdaU, 0x21634221U,
<a name="l00233"></a>00233   0x10302010U, 0xff1ae5ffU, 0xf30efdf3U, 0xd26dbfd2U,
<a name="l00234"></a>00234   0xcd4c81cdU, 0x0c14180cU, 0x13352613U, 0xec2fc3ecU,
<a name="l00235"></a>00235   0x5fe1be5fU, 0x97a23597U, 0x44cc8844U, 0x17392e17U,
<a name="l00236"></a>00236   0xc45793c4U, 0xa7f255a7U, 0x7e82fc7eU, 0x3d477a3dU,
<a name="l00237"></a>00237   0x64acc864U, 0x5de7ba5dU, 0x192b3219U, 0x7395e673U,
<a name="l00238"></a>00238   0x60a0c060U, 0x81981981U, 0x4fd19e4fU, 0xdc7fa3dcU,
<a name="l00239"></a>00239   0x22664422U, 0x2a7e542aU, 0x90ab3b90U, 0x88830b88U,
<a name="l00240"></a>00240   0x46ca8c46U, 0xee29c7eeU, 0xb8d36bb8U, 0x143c2814U,
<a name="l00241"></a>00241   0xde79a7deU, 0x5ee2bc5eU, 0x0b1d160bU, 0xdb76addbU,
<a name="l00242"></a>00242   0xe03bdbe0U, 0x32566432U, 0x3a4e743aU, 0x0a1e140aU,
<a name="l00243"></a>00243   0x49db9249U, 0x060a0c06U, 0x246c4824U, 0x5ce4b85cU,
<a name="l00244"></a>00244   0xc25d9fc2U, 0xd36ebdd3U, 0xacef43acU, 0x62a6c462U,
<a name="l00245"></a>00245   0x91a83991U, 0x95a43195U, 0xe437d3e4U, 0x798bf279U,
<a name="l00246"></a>00246   0xe732d5e7U, 0xc8438bc8U, 0x37596e37U, 0x6db7da6dU,
<a name="l00247"></a>00247   0x8d8c018dU, 0xd564b1d5U, 0x4ed29c4eU, 0xa9e049a9U,
<a name="l00248"></a>00248   0x6cb4d86cU, 0x56faac56U, 0xf407f3f4U, 0xea25cfeaU,
<a name="l00249"></a>00249   0x65afca65U, 0x7a8ef47aU, 0xaee947aeU, 0x08181008U,
<a name="l00250"></a>00250   0xbad56fbaU, 0x7888f078U, 0x256f4a25U, 0x2e725c2eU,
<a name="l00251"></a>00251   0x1c24381cU, 0xa6f157a6U, 0xb4c773b4U, 0xc65197c6U,
<a name="l00252"></a>00252   0xe823cbe8U, 0xdd7ca1ddU, 0x749ce874U, 0x1f213e1fU,
<a name="l00253"></a>00253   0x4bdd964bU, 0xbddc61bdU, 0x8b860d8bU, 0x8a850f8aU,
<a name="l00254"></a>00254   0x7090e070U, 0x3e427c3eU, 0xb5c471b5U, 0x66aacc66U,
<a name="l00255"></a>00255   0x48d89048U, 0x03050603U, 0xf601f7f6U, 0x0e121c0eU,
<a name="l00256"></a>00256   0x61a3c261U, 0x355f6a35U, 0x57f9ae57U, 0xb9d069b9U,
<a name="l00257"></a>00257   0x86911786U, 0xc15899c1U, 0x1d273a1dU, 0x9eb9279eU,
<a name="l00258"></a>00258   0xe138d9e1U, 0xf813ebf8U, 0x98b32b98U, 0x11332211U,
<a name="l00259"></a>00259   0x69bbd269U, 0xd970a9d9U, 0x8e89078eU, 0x94a73394U,
<a name="l00260"></a>00260   0x9bb62d9bU, 0x1e223c1eU, 0x87921587U, 0xe920c9e9U,
<a name="l00261"></a>00261   0xce4987ceU, 0x55ffaa55U, 0x28785028U, 0xdf7aa5dfU,
<a name="l00262"></a>00262   0x8c8f038cU, 0xa1f859a1U, 0x89800989U, 0x0d171a0dU,
<a name="l00263"></a>00263   0xbfda65bfU, 0xe631d7e6U, 0x42c68442U, 0x68b8d068U,
<a name="l00264"></a>00264   0x41c38241U, 0x99b02999U, 0x2d775a2dU, 0x0f111e0fU,
<a name="l00265"></a>00265   0xb0cb7bb0U, 0x54fca854U, 0xbbd66dbbU, 0x163a2c16U,
<a name="l00266"></a>00266 };
<a name="l00267"></a>00267 
<a name="l00268"></a>00268 <span class="keyword">static</span> <span class="keyword">const</span> u32 Te3[256] =
<a name="l00269"></a>00269 {
<a name="l00270"></a>00270   0x6363a5c6U, 0x7c7c84f8U, 0x777799eeU, 0x7b7b8df6U,
<a name="l00271"></a>00271   0xf2f20dffU, 0x6b6bbdd6U, 0x6f6fb1deU, 0xc5c55491U,
<a name="l00272"></a>00272   0x30305060U, 0x01010302U, 0x6767a9ceU, 0x2b2b7d56U,
<a name="l00273"></a>00273   0xfefe19e7U, 0xd7d762b5U, 0xababe64dU, 0x76769aecU,
<a name="l00274"></a>00274   0xcaca458fU, 0x82829d1fU, 0xc9c94089U, 0x7d7d87faU,
<a name="l00275"></a>00275   0xfafa15efU, 0x5959ebb2U, 0x4747c98eU, 0xf0f00bfbU,
<a name="l00276"></a>00276   0xadadec41U, 0xd4d467b3U, 0xa2a2fd5fU, 0xafafea45U,
<a name="l00277"></a>00277   0x9c9cbf23U, 0xa4a4f753U, 0x727296e4U, 0xc0c05b9bU,
<a name="l00278"></a>00278   0xb7b7c275U, 0xfdfd1ce1U, 0x9393ae3dU, 0x26266a4cU,
<a name="l00279"></a>00279   0x36365a6cU, 0x3f3f417eU, 0xf7f702f5U, 0xcccc4f83U,
<a name="l00280"></a>00280   0x34345c68U, 0xa5a5f451U, 0xe5e534d1U, 0xf1f108f9U,
<a name="l00281"></a>00281   0x717193e2U, 0xd8d873abU, 0x31315362U, 0x15153f2aU,
<a name="l00282"></a>00282   0x04040c08U, 0xc7c75295U, 0x23236546U, 0xc3c35e9dU,
<a name="l00283"></a>00283   0x18182830U, 0x9696a137U, 0x05050f0aU, 0x9a9ab52fU,
<a name="l00284"></a>00284   0x0707090eU, 0x12123624U, 0x80809b1bU, 0xe2e23ddfU,
<a name="l00285"></a>00285   0xebeb26cdU, 0x2727694eU, 0xb2b2cd7fU, 0x75759feaU,
<a name="l00286"></a>00286   0x09091b12U, 0x83839e1dU, 0x2c2c7458U, 0x1a1a2e34U,
<a name="l00287"></a>00287   0x1b1b2d36U, 0x6e6eb2dcU, 0x5a5aeeb4U, 0xa0a0fb5bU,
<a name="l00288"></a>00288   0x5252f6a4U, 0x3b3b4d76U, 0xd6d661b7U, 0xb3b3ce7dU,
<a name="l00289"></a>00289   0x29297b52U, 0xe3e33eddU, 0x2f2f715eU, 0x84849713U,
<a name="l00290"></a>00290   0x5353f5a6U, 0xd1d168b9U, 0x00000000U, 0xeded2cc1U,
<a name="l00291"></a>00291   0x20206040U, 0xfcfc1fe3U, 0xb1b1c879U, 0x5b5bedb6U,
<a name="l00292"></a>00292   0x6a6abed4U, 0xcbcb468dU, 0xbebed967U, 0x39394b72U,
<a name="l00293"></a>00293   0x4a4ade94U, 0x4c4cd498U, 0x5858e8b0U, 0xcfcf4a85U,
<a name="l00294"></a>00294   0xd0d06bbbU, 0xefef2ac5U, 0xaaaae54fU, 0xfbfb16edU,
<a name="l00295"></a>00295   0x4343c586U, 0x4d4dd79aU, 0x33335566U, 0x85859411U,
<a name="l00296"></a>00296   0x4545cf8aU, 0xf9f910e9U, 0x02020604U, 0x7f7f81feU,
<a name="l00297"></a>00297   0x5050f0a0U, 0x3c3c4478U, 0x9f9fba25U, 0xa8a8e34bU,
<a name="l00298"></a>00298   0x5151f3a2U, 0xa3a3fe5dU, 0x4040c080U, 0x8f8f8a05U,
<a name="l00299"></a>00299   0x9292ad3fU, 0x9d9dbc21U, 0x38384870U, 0xf5f504f1U,
<a name="l00300"></a>00300   0xbcbcdf63U, 0xb6b6c177U, 0xdada75afU, 0x21216342U,
<a name="l00301"></a>00301   0x10103020U, 0xffff1ae5U, 0xf3f30efdU, 0xd2d26dbfU,
<a name="l00302"></a>00302   0xcdcd4c81U, 0x0c0c1418U, 0x13133526U, 0xecec2fc3U,
<a name="l00303"></a>00303   0x5f5fe1beU, 0x9797a235U, 0x4444cc88U, 0x1717392eU,
<a name="l00304"></a>00304   0xc4c45793U, 0xa7a7f255U, 0x7e7e82fcU, 0x3d3d477aU,
<a name="l00305"></a>00305   0x6464acc8U, 0x5d5de7baU, 0x19192b32U, 0x737395e6U,
<a name="l00306"></a>00306   0x6060a0c0U, 0x81819819U, 0x4f4fd19eU, 0xdcdc7fa3U,
<a name="l00307"></a>00307   0x22226644U, 0x2a2a7e54U, 0x9090ab3bU, 0x8888830bU,
<a name="l00308"></a>00308   0x4646ca8cU, 0xeeee29c7U, 0xb8b8d36bU, 0x14143c28U,
<a name="l00309"></a>00309   0xdede79a7U, 0x5e5ee2bcU, 0x0b0b1d16U, 0xdbdb76adU,
<a name="l00310"></a>00310   0xe0e03bdbU, 0x32325664U, 0x3a3a4e74U, 0x0a0a1e14U,
<a name="l00311"></a>00311   0x4949db92U, 0x06060a0cU, 0x24246c48U, 0x5c5ce4b8U,
<a name="l00312"></a>00312   0xc2c25d9fU, 0xd3d36ebdU, 0xacacef43U, 0x6262a6c4U,
<a name="l00313"></a>00313   0x9191a839U, 0x9595a431U, 0xe4e437d3U, 0x79798bf2U,
<a name="l00314"></a>00314   0xe7e732d5U, 0xc8c8438bU, 0x3737596eU, 0x6d6db7daU,
<a name="l00315"></a>00315   0x8d8d8c01U, 0xd5d564b1U, 0x4e4ed29cU, 0xa9a9e049U,
<a name="l00316"></a>00316   0x6c6cb4d8U, 0x5656faacU, 0xf4f407f3U, 0xeaea25cfU,
<a name="l00317"></a>00317   0x6565afcaU, 0x7a7a8ef4U, 0xaeaee947U, 0x08081810U,
<a name="l00318"></a>00318   0xbabad56fU, 0x787888f0U, 0x25256f4aU, 0x2e2e725cU,
<a name="l00319"></a>00319   0x1c1c2438U, 0xa6a6f157U, 0xb4b4c773U, 0xc6c65197U,
<a name="l00320"></a>00320   0xe8e823cbU, 0xdddd7ca1U, 0x74749ce8U, 0x1f1f213eU,
<a name="l00321"></a>00321   0x4b4bdd96U, 0xbdbddc61U, 0x8b8b860dU, 0x8a8a850fU,
<a name="l00322"></a>00322   0x707090e0U, 0x3e3e427cU, 0xb5b5c471U, 0x6666aaccU,
<a name="l00323"></a>00323   0x4848d890U, 0x03030506U, 0xf6f601f7U, 0x0e0e121cU,
<a name="l00324"></a>00324   0x6161a3c2U, 0x35355f6aU, 0x5757f9aeU, 0xb9b9d069U,
<a name="l00325"></a>00325   0x86869117U, 0xc1c15899U, 0x1d1d273aU, 0x9e9eb927U,
<a name="l00326"></a>00326   0xe1e138d9U, 0xf8f813ebU, 0x9898b32bU, 0x11113322U,
<a name="l00327"></a>00327   0x6969bbd2U, 0xd9d970a9U, 0x8e8e8907U, 0x9494a733U,
<a name="l00328"></a>00328   0x9b9bb62dU, 0x1e1e223cU, 0x87879215U, 0xe9e920c9U,
<a name="l00329"></a>00329   0xcece4987U, 0x5555ffaaU, 0x28287850U, 0xdfdf7aa5U,
<a name="l00330"></a>00330   0x8c8c8f03U, 0xa1a1f859U, 0x89898009U, 0x0d0d171aU,
<a name="l00331"></a>00331   0xbfbfda65U, 0xe6e631d7U, 0x4242c684U, 0x6868b8d0U,
<a name="l00332"></a>00332   0x4141c382U, 0x9999b029U, 0x2d2d775aU, 0x0f0f111eU,
<a name="l00333"></a>00333   0xb0b0cb7bU, 0x5454fca8U, 0xbbbbd66dU, 0x16163a2cU,
<a name="l00334"></a>00334 };
<a name="l00335"></a>00335 
<a name="l00336"></a>00336 <span class="keyword">static</span> <span class="keyword">const</span> u32 Te4[256] =
<a name="l00337"></a>00337 {
<a name="l00338"></a>00338   0x63636363U, 0x7c7c7c7cU, 0x77777777U, 0x7b7b7b7bU,
<a name="l00339"></a>00339   0xf2f2f2f2U, 0x6b6b6b6bU, 0x6f6f6f6fU, 0xc5c5c5c5U,
<a name="l00340"></a>00340   0x30303030U, 0x01010101U, 0x67676767U, 0x2b2b2b2bU,
<a name="l00341"></a>00341   0xfefefefeU, 0xd7d7d7d7U, 0xababababU, 0x76767676U,
<a name="l00342"></a>00342   0xcacacacaU, 0x82828282U, 0xc9c9c9c9U, 0x7d7d7d7dU,
<a name="l00343"></a>00343   0xfafafafaU, 0x59595959U, 0x47474747U, 0xf0f0f0f0U,
<a name="l00344"></a>00344   0xadadadadU, 0xd4d4d4d4U, 0xa2a2a2a2U, 0xafafafafU,
<a name="l00345"></a>00345   0x9c9c9c9cU, 0xa4a4a4a4U, 0x72727272U, 0xc0c0c0c0U,
<a name="l00346"></a>00346   0xb7b7b7b7U, 0xfdfdfdfdU, 0x93939393U, 0x26262626U,
<a name="l00347"></a>00347   0x36363636U, 0x3f3f3f3fU, 0xf7f7f7f7U, 0xccccccccU,
<a name="l00348"></a>00348   0x34343434U, 0xa5a5a5a5U, 0xe5e5e5e5U, 0xf1f1f1f1U,
<a name="l00349"></a>00349   0x71717171U, 0xd8d8d8d8U, 0x31313131U, 0x15151515U,
<a name="l00350"></a>00350   0x04040404U, 0xc7c7c7c7U, 0x23232323U, 0xc3c3c3c3U,
<a name="l00351"></a>00351   0x18181818U, 0x96969696U, 0x05050505U, 0x9a9a9a9aU,
<a name="l00352"></a>00352   0x07070707U, 0x12121212U, 0x80808080U, 0xe2e2e2e2U,
<a name="l00353"></a>00353   0xebebebebU, 0x27272727U, 0xb2b2b2b2U, 0x75757575U,
<a name="l00354"></a>00354   0x09090909U, 0x83838383U, 0x2c2c2c2cU, 0x1a1a1a1aU,
<a name="l00355"></a>00355   0x1b1b1b1bU, 0x6e6e6e6eU, 0x5a5a5a5aU, 0xa0a0a0a0U,
<a name="l00356"></a>00356   0x52525252U, 0x3b3b3b3bU, 0xd6d6d6d6U, 0xb3b3b3b3U,
<a name="l00357"></a>00357   0x29292929U, 0xe3e3e3e3U, 0x2f2f2f2fU, 0x84848484U,
<a name="l00358"></a>00358   0x53535353U, 0xd1d1d1d1U, 0x00000000U, 0xededededU,
<a name="l00359"></a>00359   0x20202020U, 0xfcfcfcfcU, 0xb1b1b1b1U, 0x5b5b5b5bU,
<a name="l00360"></a>00360   0x6a6a6a6aU, 0xcbcbcbcbU, 0xbebebebeU, 0x39393939U,
<a name="l00361"></a>00361   0x4a4a4a4aU, 0x4c4c4c4cU, 0x58585858U, 0xcfcfcfcfU,
<a name="l00362"></a>00362   0xd0d0d0d0U, 0xefefefefU, 0xaaaaaaaaU, 0xfbfbfbfbU,
<a name="l00363"></a>00363   0x43434343U, 0x4d4d4d4dU, 0x33333333U, 0x85858585U,
<a name="l00364"></a>00364   0x45454545U, 0xf9f9f9f9U, 0x02020202U, 0x7f7f7f7fU,
<a name="l00365"></a>00365   0x50505050U, 0x3c3c3c3cU, 0x9f9f9f9fU, 0xa8a8a8a8U,
<a name="l00366"></a>00366   0x51515151U, 0xa3a3a3a3U, 0x40404040U, 0x8f8f8f8fU,
<a name="l00367"></a>00367   0x92929292U, 0x9d9d9d9dU, 0x38383838U, 0xf5f5f5f5U,
<a name="l00368"></a>00368   0xbcbcbcbcU, 0xb6b6b6b6U, 0xdadadadaU, 0x21212121U,
<a name="l00369"></a>00369   0x10101010U, 0xffffffffU, 0xf3f3f3f3U, 0xd2d2d2d2U,
<a name="l00370"></a>00370   0xcdcdcdcdU, 0x0c0c0c0cU, 0x13131313U, 0xececececU,
<a name="l00371"></a>00371   0x5f5f5f5fU, 0x97979797U, 0x44444444U, 0x17171717U,
<a name="l00372"></a>00372   0xc4c4c4c4U, 0xa7a7a7a7U, 0x7e7e7e7eU, 0x3d3d3d3dU,
<a name="l00373"></a>00373   0x64646464U, 0x5d5d5d5dU, 0x19191919U, 0x73737373U,
<a name="l00374"></a>00374   0x60606060U, 0x81818181U, 0x4f4f4f4fU, 0xdcdcdcdcU,
<a name="l00375"></a>00375   0x22222222U, 0x2a2a2a2aU, 0x90909090U, 0x88888888U,
<a name="l00376"></a>00376   0x46464646U, 0xeeeeeeeeU, 0xb8b8b8b8U, 0x14141414U,
<a name="l00377"></a>00377   0xdedededeU, 0x5e5e5e5eU, 0x0b0b0b0bU, 0xdbdbdbdbU,
<a name="l00378"></a>00378   0xe0e0e0e0U, 0x32323232U, 0x3a3a3a3aU, 0x0a0a0a0aU,
<a name="l00379"></a>00379   0x49494949U, 0x06060606U, 0x24242424U, 0x5c5c5c5cU,
<a name="l00380"></a>00380   0xc2c2c2c2U, 0xd3d3d3d3U, 0xacacacacU, 0x62626262U,
<a name="l00381"></a>00381   0x91919191U, 0x95959595U, 0xe4e4e4e4U, 0x79797979U,
<a name="l00382"></a>00382   0xe7e7e7e7U, 0xc8c8c8c8U, 0x37373737U, 0x6d6d6d6dU,
<a name="l00383"></a>00383   0x8d8d8d8dU, 0xd5d5d5d5U, 0x4e4e4e4eU, 0xa9a9a9a9U,
<a name="l00384"></a>00384   0x6c6c6c6cU, 0x56565656U, 0xf4f4f4f4U, 0xeaeaeaeaU,
<a name="l00385"></a>00385   0x65656565U, 0x7a7a7a7aU, 0xaeaeaeaeU, 0x08080808U,
<a name="l00386"></a>00386   0xbabababaU, 0x78787878U, 0x25252525U, 0x2e2e2e2eU,
<a name="l00387"></a>00387   0x1c1c1c1cU, 0xa6a6a6a6U, 0xb4b4b4b4U, 0xc6c6c6c6U,
<a name="l00388"></a>00388   0xe8e8e8e8U, 0xddddddddU, 0x74747474U, 0x1f1f1f1fU,
<a name="l00389"></a>00389   0x4b4b4b4bU, 0xbdbdbdbdU, 0x8b8b8b8bU, 0x8a8a8a8aU,
<a name="l00390"></a>00390   0x70707070U, 0x3e3e3e3eU, 0xb5b5b5b5U, 0x66666666U,
<a name="l00391"></a>00391   0x48484848U, 0x03030303U, 0xf6f6f6f6U, 0x0e0e0e0eU,
<a name="l00392"></a>00392   0x61616161U, 0x35353535U, 0x57575757U, 0xb9b9b9b9U,
<a name="l00393"></a>00393   0x86868686U, 0xc1c1c1c1U, 0x1d1d1d1dU, 0x9e9e9e9eU,
<a name="l00394"></a>00394   0xe1e1e1e1U, 0xf8f8f8f8U, 0x98989898U, 0x11111111U,
<a name="l00395"></a>00395   0x69696969U, 0xd9d9d9d9U, 0x8e8e8e8eU, 0x94949494U,
<a name="l00396"></a>00396   0x9b9b9b9bU, 0x1e1e1e1eU, 0x87878787U, 0xe9e9e9e9U,
<a name="l00397"></a>00397   0xcecececeU, 0x55555555U, 0x28282828U, 0xdfdfdfdfU,
<a name="l00398"></a>00398   0x8c8c8c8cU, 0xa1a1a1a1U, 0x89898989U, 0x0d0d0d0dU,
<a name="l00399"></a>00399   0xbfbfbfbfU, 0xe6e6e6e6U, 0x42424242U, 0x68686868U,
<a name="l00400"></a>00400   0x41414141U, 0x99999999U, 0x2d2d2d2dU, 0x0f0f0f0fU,
<a name="l00401"></a>00401   0xb0b0b0b0U, 0x54545454U, 0xbbbbbbbbU, 0x16161616U,
<a name="l00402"></a>00402 };
<a name="l00403"></a>00403 
<a name="l00404"></a>00404 <span class="keyword">static</span> <span class="keyword">const</span> u32 Td0[256] =
<a name="l00405"></a>00405 {
<a name="l00406"></a>00406   0x51f4a750U, 0x7e416553U, 0x1a17a4c3U, 0x3a275e96U,
<a name="l00407"></a>00407   0x3bab6bcbU, 0x1f9d45f1U, 0xacfa58abU, 0x4be30393U,
<a name="l00408"></a>00408   0x2030fa55U, 0xad766df6U, 0x88cc7691U, 0xf5024c25U,
<a name="l00409"></a>00409   0x4fe5d7fcU, 0xc52acbd7U, 0x26354480U, 0xb562a38fU,
<a name="l00410"></a>00410   0xdeb15a49U, 0x25ba1b67U, 0x45ea0e98U, 0x5dfec0e1U,
<a name="l00411"></a>00411   0xc32f7502U, 0x814cf012U, 0x8d4697a3U, 0x6bd3f9c6U,
<a name="l00412"></a>00412   0x038f5fe7U, 0x15929c95U, 0xbf6d7aebU, 0x955259daU,
<a name="l00413"></a>00413   0xd4be832dU, 0x587421d3U, 0x49e06929U, 0x8ec9c844U,
<a name="l00414"></a>00414   0x75c2896aU, 0xf48e7978U, 0x99583e6bU, 0x27b971ddU,
<a name="l00415"></a>00415   0xbee14fb6U, 0xf088ad17U, 0xc920ac66U, 0x7dce3ab4U,
<a name="l00416"></a>00416   0x63df4a18U, 0xe51a3182U, 0x97513360U, 0x62537f45U,
<a name="l00417"></a>00417   0xb16477e0U, 0xbb6bae84U, 0xfe81a01cU, 0xf9082b94U,
<a name="l00418"></a>00418   0x70486858U, 0x8f45fd19U, 0x94de6c87U, 0x527bf8b7U,
<a name="l00419"></a>00419   0xab73d323U, 0x724b02e2U, 0xe31f8f57U, 0x6655ab2aU,
<a name="l00420"></a>00420   0xb2eb2807U, 0x2fb5c203U, 0x86c57b9aU, 0xd33708a5U,
<a name="l00421"></a>00421   0x302887f2U, 0x23bfa5b2U, 0x02036abaU, 0xed16825cU,
<a name="l00422"></a>00422   0x8acf1c2bU, 0xa779b492U, 0xf307f2f0U, 0x4e69e2a1U,
<a name="l00423"></a>00423   0x65daf4cdU, 0x0605bed5U, 0xd134621fU, 0xc4a6fe8aU,
<a name="l00424"></a>00424   0x342e539dU, 0xa2f355a0U, 0x058ae132U, 0xa4f6eb75U,
<a name="l00425"></a>00425   0x0b83ec39U, 0x4060efaaU, 0x5e719f06U, 0xbd6e1051U,
<a name="l00426"></a>00426   0x3e218af9U, 0x96dd063dU, 0xdd3e05aeU, 0x4de6bd46U,
<a name="l00427"></a>00427   0x91548db5U, 0x71c45d05U, 0x0406d46fU, 0x605015ffU,
<a name="l00428"></a>00428   0x1998fb24U, 0xd6bde997U, 0x894043ccU, 0x67d99e77U,
<a name="l00429"></a>00429   0xb0e842bdU, 0x07898b88U, 0xe7195b38U, 0x79c8eedbU,
<a name="l00430"></a>00430   0xa17c0a47U, 0x7c420fe9U, 0xf8841ec9U, 0x00000000U,
<a name="l00431"></a>00431   0x09808683U, 0x322bed48U, 0x1e1170acU, 0x6c5a724eU,
<a name="l00432"></a>00432   0xfd0efffbU, 0x0f853856U, 0x3daed51eU, 0x362d3927U,
<a name="l00433"></a>00433   0x0a0fd964U, 0x685ca621U, 0x9b5b54d1U, 0x24362e3aU,
<a name="l00434"></a>00434   0x0c0a67b1U, 0x9357e70fU, 0xb4ee96d2U, 0x1b9b919eU,
<a name="l00435"></a>00435   0x80c0c54fU, 0x61dc20a2U, 0x5a774b69U, 0x1c121a16U,
<a name="l00436"></a>00436   0xe293ba0aU, 0xc0a02ae5U, 0x3c22e043U, 0x121b171dU,
<a name="l00437"></a>00437   0x0e090d0bU, 0xf28bc7adU, 0x2db6a8b9U, 0x141ea9c8U,
<a name="l00438"></a>00438   0x57f11985U, 0xaf75074cU, 0xee99ddbbU, 0xa37f60fdU,
<a name="l00439"></a>00439   0xf701269fU, 0x5c72f5bcU, 0x44663bc5U, 0x5bfb7e34U,
<a name="l00440"></a>00440   0x8b432976U, 0xcb23c6dcU, 0xb6edfc68U, 0xb8e4f163U,
<a name="l00441"></a>00441   0xd731dccaU, 0x42638510U, 0x13972240U, 0x84c61120U,
<a name="l00442"></a>00442   0x854a247dU, 0xd2bb3df8U, 0xaef93211U, 0xc729a16dU,
<a name="l00443"></a>00443   0x1d9e2f4bU, 0xdcb230f3U, 0x0d8652ecU, 0x77c1e3d0U,
<a name="l00444"></a>00444   0x2bb3166cU, 0xa970b999U, 0x119448faU, 0x47e96422U,
<a name="l00445"></a>00445   0xa8fc8cc4U, 0xa0f03f1aU, 0x567d2cd8U, 0x223390efU,
<a name="l00446"></a>00446   0x87494ec7U, 0xd938d1c1U, 0x8ccaa2feU, 0x98d40b36U,
<a name="l00447"></a>00447   0xa6f581cfU, 0xa57ade28U, 0xdab78e26U, 0x3fadbfa4U,
<a name="l00448"></a>00448   0x2c3a9de4U, 0x5078920dU, 0x6a5fcc9bU, 0x547e4662U,
<a name="l00449"></a>00449   0xf68d13c2U, 0x90d8b8e8U, 0x2e39f75eU, 0x82c3aff5U,
<a name="l00450"></a>00450   0x9f5d80beU, 0x69d0937cU, 0x6fd52da9U, 0xcf2512b3U,
<a name="l00451"></a>00451   0xc8ac993bU, 0x10187da7U, 0xe89c636eU, 0xdb3bbb7bU,
<a name="l00452"></a>00452   0xcd267809U, 0x6e5918f4U, 0xec9ab701U, 0x834f9aa8U,
<a name="l00453"></a>00453   0xe6956e65U, 0xaaffe67eU, 0x21bccf08U, 0xef15e8e6U,
<a name="l00454"></a>00454   0xbae79bd9U, 0x4a6f36ceU, 0xea9f09d4U, 0x29b07cd6U,
<a name="l00455"></a>00455   0x31a4b2afU, 0x2a3f2331U, 0xc6a59430U, 0x35a266c0U,
<a name="l00456"></a>00456   0x744ebc37U, 0xfc82caa6U, 0xe090d0b0U, 0x33a7d815U,
<a name="l00457"></a>00457   0xf104984aU, 0x41ecdaf7U, 0x7fcd500eU, 0x1791f62fU,
<a name="l00458"></a>00458   0x764dd68dU, 0x43efb04dU, 0xccaa4d54U, 0xe49604dfU,
<a name="l00459"></a>00459   0x9ed1b5e3U, 0x4c6a881bU, 0xc12c1fb8U, 0x4665517fU,
<a name="l00460"></a>00460   0x9d5eea04U, 0x018c355dU, 0xfa877473U, 0xfb0b412eU,
<a name="l00461"></a>00461   0xb3671d5aU, 0x92dbd252U, 0xe9105633U, 0x6dd64713U,
<a name="l00462"></a>00462   0x9ad7618cU, 0x37a10c7aU, 0x59f8148eU, 0xeb133c89U,
<a name="l00463"></a>00463   0xcea927eeU, 0xb761c935U, 0xe11ce5edU, 0x7a47b13cU,
<a name="l00464"></a>00464   0x9cd2df59U, 0x55f2733fU, 0x1814ce79U, 0x73c737bfU,
<a name="l00465"></a>00465   0x53f7cdeaU, 0x5ffdaa5bU, 0xdf3d6f14U, 0x7844db86U,
<a name="l00466"></a>00466   0xcaaff381U, 0xb968c43eU, 0x3824342cU, 0xc2a3405fU,
<a name="l00467"></a>00467   0x161dc372U, 0xbce2250cU, 0x283c498bU, 0xff0d9541U,
<a name="l00468"></a>00468   0x39a80171U, 0x080cb3deU, 0xd8b4e49cU, 0x6456c190U,
<a name="l00469"></a>00469   0x7bcb8461U, 0xd532b670U, 0x486c5c74U, 0xd0b85742U,
<a name="l00470"></a>00470 };
<a name="l00471"></a>00471 
<a name="l00472"></a>00472 <span class="keyword">static</span> <span class="keyword">const</span> u32 Td1[256] =
<a name="l00473"></a>00473 {
<a name="l00474"></a>00474   0x5051f4a7U, 0x537e4165U, 0xc31a17a4U, 0x963a275eU,
<a name="l00475"></a>00475   0xcb3bab6bU, 0xf11f9d45U, 0xabacfa58U, 0x934be303U,
<a name="l00476"></a>00476   0x552030faU, 0xf6ad766dU, 0x9188cc76U, 0x25f5024cU,
<a name="l00477"></a>00477   0xfc4fe5d7U, 0xd7c52acbU, 0x80263544U, 0x8fb562a3U,
<a name="l00478"></a>00478   0x49deb15aU, 0x6725ba1bU, 0x9845ea0eU, 0xe15dfec0U,
<a name="l00479"></a>00479   0x02c32f75U, 0x12814cf0U, 0xa38d4697U, 0xc66bd3f9U,
<a name="l00480"></a>00480   0xe7038f5fU, 0x9515929cU, 0xebbf6d7aU, 0xda955259U,
<a name="l00481"></a>00481   0x2dd4be83U, 0xd3587421U, 0x2949e069U, 0x448ec9c8U,
<a name="l00482"></a>00482   0x6a75c289U, 0x78f48e79U, 0x6b99583eU, 0xdd27b971U,
<a name="l00483"></a>00483   0xb6bee14fU, 0x17f088adU, 0x66c920acU, 0xb47dce3aU,
<a name="l00484"></a>00484   0x1863df4aU, 0x82e51a31U, 0x60975133U, 0x4562537fU,
<a name="l00485"></a>00485   0xe0b16477U, 0x84bb6baeU, 0x1cfe81a0U, 0x94f9082bU,
<a name="l00486"></a>00486   0x58704868U, 0x198f45fdU, 0x8794de6cU, 0xb7527bf8U,
<a name="l00487"></a>00487   0x23ab73d3U, 0xe2724b02U, 0x57e31f8fU, 0x2a6655abU,
<a name="l00488"></a>00488   0x07b2eb28U, 0x032fb5c2U, 0x9a86c57bU, 0xa5d33708U,
<a name="l00489"></a>00489   0xf2302887U, 0xb223bfa5U, 0xba02036aU, 0x5ced1682U,
<a name="l00490"></a>00490   0x2b8acf1cU, 0x92a779b4U, 0xf0f307f2U, 0xa14e69e2U,
<a name="l00491"></a>00491   0xcd65daf4U, 0xd50605beU, 0x1fd13462U, 0x8ac4a6feU,
<a name="l00492"></a>00492   0x9d342e53U, 0xa0a2f355U, 0x32058ae1U, 0x75a4f6ebU,
<a name="l00493"></a>00493   0x390b83ecU, 0xaa4060efU, 0x065e719fU, 0x51bd6e10U,
<a name="l00494"></a>00494   0xf93e218aU, 0x3d96dd06U, 0xaedd3e05U, 0x464de6bdU,
<a name="l00495"></a>00495   0xb591548dU, 0x0571c45dU, 0x6f0406d4U, 0xff605015U,
<a name="l00496"></a>00496   0x241998fbU, 0x97d6bde9U, 0xcc894043U, 0x7767d99eU,
<a name="l00497"></a>00497   0xbdb0e842U, 0x8807898bU, 0x38e7195bU, 0xdb79c8eeU,
<a name="l00498"></a>00498   0x47a17c0aU, 0xe97c420fU, 0xc9f8841eU, 0x00000000U,
<a name="l00499"></a>00499   0x83098086U, 0x48322bedU, 0xac1e1170U, 0x4e6c5a72U,
<a name="l00500"></a>00500   0xfbfd0effU, 0x560f8538U, 0x1e3daed5U, 0x27362d39U,
<a name="l00501"></a>00501   0x640a0fd9U, 0x21685ca6U, 0xd19b5b54U, 0x3a24362eU,
<a name="l00502"></a>00502   0xb10c0a67U, 0x0f9357e7U, 0xd2b4ee96U, 0x9e1b9b91U,
<a name="l00503"></a>00503   0x4f80c0c5U, 0xa261dc20U, 0x695a774bU, 0x161c121aU,
<a name="l00504"></a>00504   0x0ae293baU, 0xe5c0a02aU, 0x433c22e0U, 0x1d121b17U,
<a name="l00505"></a>00505   0x0b0e090dU, 0xadf28bc7U, 0xb92db6a8U, 0xc8141ea9U,
<a name="l00506"></a>00506   0x8557f119U, 0x4caf7507U, 0xbbee99ddU, 0xfda37f60U,
<a name="l00507"></a>00507   0x9ff70126U, 0xbc5c72f5U, 0xc544663bU, 0x345bfb7eU,
<a name="l00508"></a>00508   0x768b4329U, 0xdccb23c6U, 0x68b6edfcU, 0x63b8e4f1U,
<a name="l00509"></a>00509   0xcad731dcU, 0x10426385U, 0x40139722U, 0x2084c611U,
<a name="l00510"></a>00510   0x7d854a24U, 0xf8d2bb3dU, 0x11aef932U, 0x6dc729a1U,
<a name="l00511"></a>00511   0x4b1d9e2fU, 0xf3dcb230U, 0xec0d8652U, 0xd077c1e3U,
<a name="l00512"></a>00512   0x6c2bb316U, 0x99a970b9U, 0xfa119448U, 0x2247e964U,
<a name="l00513"></a>00513   0xc4a8fc8cU, 0x1aa0f03fU, 0xd8567d2cU, 0xef223390U,
<a name="l00514"></a>00514   0xc787494eU, 0xc1d938d1U, 0xfe8ccaa2U, 0x3698d40bU,
<a name="l00515"></a>00515   0xcfa6f581U, 0x28a57adeU, 0x26dab78eU, 0xa43fadbfU,
<a name="l00516"></a>00516   0xe42c3a9dU, 0x0d507892U, 0x9b6a5fccU, 0x62547e46U,
<a name="l00517"></a>00517   0xc2f68d13U, 0xe890d8b8U, 0x5e2e39f7U, 0xf582c3afU,
<a name="l00518"></a>00518   0xbe9f5d80U, 0x7c69d093U, 0xa96fd52dU, 0xb3cf2512U,
<a name="l00519"></a>00519   0x3bc8ac99U, 0xa710187dU, 0x6ee89c63U, 0x7bdb3bbbU,
<a name="l00520"></a>00520   0x09cd2678U, 0xf46e5918U, 0x01ec9ab7U, 0xa8834f9aU,
<a name="l00521"></a>00521   0x65e6956eU, 0x7eaaffe6U, 0x0821bccfU, 0xe6ef15e8U,
<a name="l00522"></a>00522   0xd9bae79bU, 0xce4a6f36U, 0xd4ea9f09U, 0xd629b07cU,
<a name="l00523"></a>00523   0xaf31a4b2U, 0x312a3f23U, 0x30c6a594U, 0xc035a266U,
<a name="l00524"></a>00524   0x37744ebcU, 0xa6fc82caU, 0xb0e090d0U, 0x1533a7d8U,
<a name="l00525"></a>00525   0x4af10498U, 0xf741ecdaU, 0x0e7fcd50U, 0x2f1791f6U,
<a name="l00526"></a>00526   0x8d764dd6U, 0x4d43efb0U, 0x54ccaa4dU, 0xdfe49604U,
<a name="l00527"></a>00527   0xe39ed1b5U, 0x1b4c6a88U, 0xb8c12c1fU, 0x7f466551U,
<a name="l00528"></a>00528   0x049d5eeaU, 0x5d018c35U, 0x73fa8774U, 0x2efb0b41U,
<a name="l00529"></a>00529   0x5ab3671dU, 0x5292dbd2U, 0x33e91056U, 0x136dd647U,
<a name="l00530"></a>00530   0x8c9ad761U, 0x7a37a10cU, 0x8e59f814U, 0x89eb133cU,
<a name="l00531"></a>00531   0xeecea927U, 0x35b761c9U, 0xede11ce5U, 0x3c7a47b1U,
<a name="l00532"></a>00532   0x599cd2dfU, 0x3f55f273U, 0x791814ceU, 0xbf73c737U,
<a name="l00533"></a>00533   0xea53f7cdU, 0x5b5ffdaaU, 0x14df3d6fU, 0x867844dbU,
<a name="l00534"></a>00534   0x81caaff3U, 0x3eb968c4U, 0x2c382434U, 0x5fc2a340U,
<a name="l00535"></a>00535   0x72161dc3U, 0x0cbce225U, 0x8b283c49U, 0x41ff0d95U,
<a name="l00536"></a>00536   0x7139a801U, 0xde080cb3U, 0x9cd8b4e4U, 0x906456c1U,
<a name="l00537"></a>00537   0x617bcb84U, 0x70d532b6U, 0x74486c5cU, 0x42d0b857U,
<a name="l00538"></a>00538 };
<a name="l00539"></a>00539 
<a name="l00540"></a>00540 <span class="keyword">static</span> <span class="keyword">const</span> u32 Td2[256] =
<a name="l00541"></a>00541 {
<a name="l00542"></a>00542   0xa75051f4U, 0x65537e41U, 0xa4c31a17U, 0x5e963a27U,
<a name="l00543"></a>00543   0x6bcb3babU, 0x45f11f9dU, 0x58abacfaU, 0x03934be3U,
<a name="l00544"></a>00544   0xfa552030U, 0x6df6ad76U, 0x769188ccU, 0x4c25f502U,
<a name="l00545"></a>00545   0xd7fc4fe5U, 0xcbd7c52aU, 0x44802635U, 0xa38fb562U,
<a name="l00546"></a>00546   0x5a49deb1U, 0x1b6725baU, 0x0e9845eaU, 0xc0e15dfeU,
<a name="l00547"></a>00547   0x7502c32fU, 0xf012814cU, 0x97a38d46U, 0xf9c66bd3U,
<a name="l00548"></a>00548   0x5fe7038fU, 0x9c951592U, 0x7aebbf6dU, 0x59da9552U,
<a name="l00549"></a>00549   0x832dd4beU, 0x21d35874U, 0x692949e0U, 0xc8448ec9U,
<a name="l00550"></a>00550   0x896a75c2U, 0x7978f48eU, 0x3e6b9958U, 0x71dd27b9U,
<a name="l00551"></a>00551   0x4fb6bee1U, 0xad17f088U, 0xac66c920U, 0x3ab47dceU,
<a name="l00552"></a>00552   0x4a1863dfU, 0x3182e51aU, 0x33609751U, 0x7f456253U,
<a name="l00553"></a>00553   0x77e0b164U, 0xae84bb6bU, 0xa01cfe81U, 0x2b94f908U,
<a name="l00554"></a>00554   0x68587048U, 0xfd198f45U, 0x6c8794deU, 0xf8b7527bU,
<a name="l00555"></a>00555   0xd323ab73U, 0x02e2724bU, 0x8f57e31fU, 0xab2a6655U,
<a name="l00556"></a>00556   0x2807b2ebU, 0xc2032fb5U, 0x7b9a86c5U, 0x08a5d337U,
<a name="l00557"></a>00557   0x87f23028U, 0xa5b223bfU, 0x6aba0203U, 0x825ced16U,
<a name="l00558"></a>00558   0x1c2b8acfU, 0xb492a779U, 0xf2f0f307U, 0xe2a14e69U,
<a name="l00559"></a>00559   0xf4cd65daU, 0xbed50605U, 0x621fd134U, 0xfe8ac4a6U,
<a name="l00560"></a>00560   0x539d342eU, 0x55a0a2f3U, 0xe132058aU, 0xeb75a4f6U,
<a name="l00561"></a>00561   0xec390b83U, 0xefaa4060U, 0x9f065e71U, 0x1051bd6eU,
<a name="l00562"></a>00562   0x8af93e21U, 0x063d96ddU, 0x05aedd3eU, 0xbd464de6U,
<a name="l00563"></a>00563   0x8db59154U, 0x5d0571c4U, 0xd46f0406U, 0x15ff6050U,
<a name="l00564"></a>00564   0xfb241998U, 0xe997d6bdU, 0x43cc8940U, 0x9e7767d9U,
<a name="l00565"></a>00565   0x42bdb0e8U, 0x8b880789U, 0x5b38e719U, 0xeedb79c8U,
<a name="l00566"></a>00566   0x0a47a17cU, 0x0fe97c42U, 0x1ec9f884U, 0x00000000U,
<a name="l00567"></a>00567   0x86830980U, 0xed48322bU, 0x70ac1e11U, 0x724e6c5aU,
<a name="l00568"></a>00568   0xfffbfd0eU, 0x38560f85U, 0xd51e3daeU, 0x3927362dU,
<a name="l00569"></a>00569   0xd9640a0fU, 0xa621685cU, 0x54d19b5bU, 0x2e3a2436U,
<a name="l00570"></a>00570   0x67b10c0aU, 0xe70f9357U, 0x96d2b4eeU, 0x919e1b9bU,
<a name="l00571"></a>00571   0xc54f80c0U, 0x20a261dcU, 0x4b695a77U, 0x1a161c12U,
<a name="l00572"></a>00572   0xba0ae293U, 0x2ae5c0a0U, 0xe0433c22U, 0x171d121bU,
<a name="l00573"></a>00573   0x0d0b0e09U, 0xc7adf28bU, 0xa8b92db6U, 0xa9c8141eU,
<a name="l00574"></a>00574   0x198557f1U, 0x074caf75U, 0xddbbee99U, 0x60fda37fU,
<a name="l00575"></a>00575   0x269ff701U, 0xf5bc5c72U, 0x3bc54466U, 0x7e345bfbU,
<a name="l00576"></a>00576   0x29768b43U, 0xc6dccb23U, 0xfc68b6edU, 0xf163b8e4U,
<a name="l00577"></a>00577   0xdccad731U, 0x85104263U, 0x22401397U, 0x112084c6U,
<a name="l00578"></a>00578   0x247d854aU, 0x3df8d2bbU, 0x3211aef9U, 0xa16dc729U,
<a name="l00579"></a>00579   0x2f4b1d9eU, 0x30f3dcb2U, 0x52ec0d86U, 0xe3d077c1U,
<a name="l00580"></a>00580   0x166c2bb3U, 0xb999a970U, 0x48fa1194U, 0x642247e9U,
<a name="l00581"></a>00581   0x8cc4a8fcU, 0x3f1aa0f0U, 0x2cd8567dU, 0x90ef2233U,
<a name="l00582"></a>00582   0x4ec78749U, 0xd1c1d938U, 0xa2fe8ccaU, 0x0b3698d4U,
<a name="l00583"></a>00583   0x81cfa6f5U, 0xde28a57aU, 0x8e26dab7U, 0xbfa43fadU,
<a name="l00584"></a>00584   0x9de42c3aU, 0x920d5078U, 0xcc9b6a5fU, 0x4662547eU,
<a name="l00585"></a>00585   0x13c2f68dU, 0xb8e890d8U, 0xf75e2e39U, 0xaff582c3U,
<a name="l00586"></a>00586   0x80be9f5dU, 0x937c69d0U, 0x2da96fd5U, 0x12b3cf25U,
<a name="l00587"></a>00587   0x993bc8acU, 0x7da71018U, 0x636ee89cU, 0xbb7bdb3bU,
<a name="l00588"></a>00588   0x7809cd26U, 0x18f46e59U, 0xb701ec9aU, 0x9aa8834fU,
<a name="l00589"></a>00589   0x6e65e695U, 0xe67eaaffU, 0xcf0821bcU, 0xe8e6ef15U,
<a name="l00590"></a>00590   0x9bd9bae7U, 0x36ce4a6fU, 0x09d4ea9fU, 0x7cd629b0U,
<a name="l00591"></a>00591   0xb2af31a4U, 0x23312a3fU, 0x9430c6a5U, 0x66c035a2U,
<a name="l00592"></a>00592   0xbc37744eU, 0xcaa6fc82U, 0xd0b0e090U, 0xd81533a7U,
<a name="l00593"></a>00593   0x984af104U, 0xdaf741ecU, 0x500e7fcdU, 0xf62f1791U,
<a name="l00594"></a>00594   0xd68d764dU, 0xb04d43efU, 0x4d54ccaaU, 0x04dfe496U,
<a name="l00595"></a>00595   0xb5e39ed1U, 0x881b4c6aU, 0x1fb8c12cU, 0x517f4665U,
<a name="l00596"></a>00596   0xea049d5eU, 0x355d018cU, 0x7473fa87U, 0x412efb0bU,
<a name="l00597"></a>00597   0x1d5ab367U, 0xd25292dbU, 0x5633e910U, 0x47136dd6U,
<a name="l00598"></a>00598   0x618c9ad7U, 0x0c7a37a1U, 0x148e59f8U, 0x3c89eb13U,
<a name="l00599"></a>00599   0x27eecea9U, 0xc935b761U, 0xe5ede11cU, 0xb13c7a47U,
<a name="l00600"></a>00600   0xdf599cd2U, 0x733f55f2U, 0xce791814U, 0x37bf73c7U,
<a name="l00601"></a>00601   0xcdea53f7U, 0xaa5b5ffdU, 0x6f14df3dU, 0xdb867844U,
<a name="l00602"></a>00602   0xf381caafU, 0xc43eb968U, 0x342c3824U, 0x405fc2a3U,
<a name="l00603"></a>00603   0xc372161dU, 0x250cbce2U, 0x498b283cU, 0x9541ff0dU,
<a name="l00604"></a>00604   0x017139a8U, 0xb3de080cU, 0xe49cd8b4U, 0xc1906456U,
<a name="l00605"></a>00605   0x84617bcbU, 0xb670d532U, 0x5c74486cU, 0x5742d0b8U,
<a name="l00606"></a>00606 };
<a name="l00607"></a>00607 
<a name="l00608"></a>00608 <span class="keyword">static</span> <span class="keyword">const</span> u32 Td3[256] =
<a name="l00609"></a>00609 {
<a name="l00610"></a>00610   0xf4a75051U, 0x4165537eU, 0x17a4c31aU, 0x275e963aU,
<a name="l00611"></a>00611   0xab6bcb3bU, 0x9d45f11fU, 0xfa58abacU, 0xe303934bU,
<a name="l00612"></a>00612   0x30fa5520U, 0x766df6adU, 0xcc769188U, 0x024c25f5U,
<a name="l00613"></a>00613   0xe5d7fc4fU, 0x2acbd7c5U, 0x35448026U, 0x62a38fb5U,
<a name="l00614"></a>00614   0xb15a49deU, 0xba1b6725U, 0xea0e9845U, 0xfec0e15dU,
<a name="l00615"></a>00615   0x2f7502c3U, 0x4cf01281U, 0x4697a38dU, 0xd3f9c66bU,
<a name="l00616"></a>00616   0x8f5fe703U, 0x929c9515U, 0x6d7aebbfU, 0x5259da95U,
<a name="l00617"></a>00617   0xbe832dd4U, 0x7421d358U, 0xe0692949U, 0xc9c8448eU,
<a name="l00618"></a>00618   0xc2896a75U, 0x8e7978f4U, 0x583e6b99U, 0xb971dd27U,
<a name="l00619"></a>00619   0xe14fb6beU, 0x88ad17f0U, 0x20ac66c9U, 0xce3ab47dU,
<a name="l00620"></a>00620   0xdf4a1863U, 0x1a3182e5U, 0x51336097U, 0x537f4562U,
<a name="l00621"></a>00621   0x6477e0b1U, 0x6bae84bbU, 0x81a01cfeU, 0x082b94f9U,
<a name="l00622"></a>00622   0x48685870U, 0x45fd198fU, 0xde6c8794U, 0x7bf8b752U,
<a name="l00623"></a>00623   0x73d323abU, 0x4b02e272U, 0x1f8f57e3U, 0x55ab2a66U,
<a name="l00624"></a>00624   0xeb2807b2U, 0xb5c2032fU, 0xc57b9a86U, 0x3708a5d3U,
<a name="l00625"></a>00625   0x2887f230U, 0xbfa5b223U, 0x036aba02U, 0x16825cedU,
<a name="l00626"></a>00626   0xcf1c2b8aU, 0x79b492a7U, 0x07f2f0f3U, 0x69e2a14eU,
<a name="l00627"></a>00627   0xdaf4cd65U, 0x05bed506U, 0x34621fd1U, 0xa6fe8ac4U,
<a name="l00628"></a>00628   0x2e539d34U, 0xf355a0a2U, 0x8ae13205U, 0xf6eb75a4U,
<a name="l00629"></a>00629   0x83ec390bU, 0x60efaa40U, 0x719f065eU, 0x6e1051bdU,
<a name="l00630"></a>00630   0x218af93eU, 0xdd063d96U, 0x3e05aeddU, 0xe6bd464dU,
<a name="l00631"></a>00631   0x548db591U, 0xc45d0571U, 0x06d46f04U, 0x5015ff60U,
<a name="l00632"></a>00632   0x98fb2419U, 0xbde997d6U, 0x4043cc89U, 0xd99e7767U,
<a name="l00633"></a>00633   0xe842bdb0U, 0x898b8807U, 0x195b38e7U, 0xc8eedb79U,
<a name="l00634"></a>00634   0x7c0a47a1U, 0x420fe97cU, 0x841ec9f8U, 0x00000000U,
<a name="l00635"></a>00635   0x80868309U, 0x2bed4832U, 0x1170ac1eU, 0x5a724e6cU,
<a name="l00636"></a>00636   0x0efffbfdU, 0x8538560fU, 0xaed51e3dU, 0x2d392736U,
<a name="l00637"></a>00637   0x0fd9640aU, 0x5ca62168U, 0x5b54d19bU, 0x362e3a24U,
<a name="l00638"></a>00638   0x0a67b10cU, 0x57e70f93U, 0xee96d2b4U, 0x9b919e1bU,
<a name="l00639"></a>00639   0xc0c54f80U, 0xdc20a261U, 0x774b695aU, 0x121a161cU,
<a name="l00640"></a>00640   0x93ba0ae2U, 0xa02ae5c0U, 0x22e0433cU, 0x1b171d12U,
<a name="l00641"></a>00641   0x090d0b0eU, 0x8bc7adf2U, 0xb6a8b92dU, 0x1ea9c814U,
<a name="l00642"></a>00642   0xf1198557U, 0x75074cafU, 0x99ddbbeeU, 0x7f60fda3U,
<a name="l00643"></a>00643   0x01269ff7U, 0x72f5bc5cU, 0x663bc544U, 0xfb7e345bU,
<a name="l00644"></a>00644   0x4329768bU, 0x23c6dccbU, 0xedfc68b6U, 0xe4f163b8U,
<a name="l00645"></a>00645   0x31dccad7U, 0x63851042U, 0x97224013U, 0xc6112084U,
<a name="l00646"></a>00646   0x4a247d85U, 0xbb3df8d2U, 0xf93211aeU, 0x29a16dc7U,
<a name="l00647"></a>00647   0x9e2f4b1dU, 0xb230f3dcU, 0x8652ec0dU, 0xc1e3d077U,
<a name="l00648"></a>00648   0xb3166c2bU, 0x70b999a9U, 0x9448fa11U, 0xe9642247U,
<a name="l00649"></a>00649   0xfc8cc4a8U, 0xf03f1aa0U, 0x7d2cd856U, 0x3390ef22U,
<a name="l00650"></a>00650   0x494ec787U, 0x38d1c1d9U, 0xcaa2fe8cU, 0xd40b3698U,
<a name="l00651"></a>00651   0xf581cfa6U, 0x7ade28a5U, 0xb78e26daU, 0xadbfa43fU,
<a name="l00652"></a>00652   0x3a9de42cU, 0x78920d50U, 0x5fcc9b6aU, 0x7e466254U,
<a name="l00653"></a>00653   0x8d13c2f6U, 0xd8b8e890U, 0x39f75e2eU, 0xc3aff582U,
<a name="l00654"></a>00654   0x5d80be9fU, 0xd0937c69U, 0xd52da96fU, 0x2512b3cfU,
<a name="l00655"></a>00655   0xac993bc8U, 0x187da710U, 0x9c636ee8U, 0x3bbb7bdbU,
<a name="l00656"></a>00656   0x267809cdU, 0x5918f46eU, 0x9ab701ecU, 0x4f9aa883U,
<a name="l00657"></a>00657   0x956e65e6U, 0xffe67eaaU, 0xbccf0821U, 0x15e8e6efU,
<a name="l00658"></a>00658   0xe79bd9baU, 0x6f36ce4aU, 0x9f09d4eaU, 0xb07cd629U,
<a name="l00659"></a>00659   0xa4b2af31U, 0x3f23312aU, 0xa59430c6U, 0xa266c035U,
<a name="l00660"></a>00660   0x4ebc3774U, 0x82caa6fcU, 0x90d0b0e0U, 0xa7d81533U,
<a name="l00661"></a>00661   0x04984af1U, 0xecdaf741U, 0xcd500e7fU, 0x91f62f17U,
<a name="l00662"></a>00662   0x4dd68d76U, 0xefb04d43U, 0xaa4d54ccU, 0x9604dfe4U,
<a name="l00663"></a>00663   0xd1b5e39eU, 0x6a881b4cU, 0x2c1fb8c1U, 0x65517f46U,
<a name="l00664"></a>00664   0x5eea049dU, 0x8c355d01U, 0x877473faU, 0x0b412efbU,
<a name="l00665"></a>00665   0x671d5ab3U, 0xdbd25292U, 0x105633e9U, 0xd647136dU,
<a name="l00666"></a>00666   0xd7618c9aU, 0xa10c7a37U, 0xf8148e59U, 0x133c89ebU,
<a name="l00667"></a>00667   0xa927eeceU, 0x61c935b7U, 0x1ce5ede1U, 0x47b13c7aU,
<a name="l00668"></a>00668   0xd2df599cU, 0xf2733f55U, 0x14ce7918U, 0xc737bf73U,
<a name="l00669"></a>00669   0xf7cdea53U, 0xfdaa5b5fU, 0x3d6f14dfU, 0x44db8678U,
<a name="l00670"></a>00670   0xaff381caU, 0x68c43eb9U, 0x24342c38U, 0xa3405fc2U,
<a name="l00671"></a>00671   0x1dc37216U, 0xe2250cbcU, 0x3c498b28U, 0x0d9541ffU,
<a name="l00672"></a>00672   0xa8017139U, 0x0cb3de08U, 0xb4e49cd8U, 0x56c19064U,
<a name="l00673"></a>00673   0xcb84617bU, 0x32b670d5U, 0x6c5c7448U, 0xb85742d0U,
<a name="l00674"></a>00674 };
<a name="l00675"></a>00675 
<a name="l00676"></a>00676 <span class="keyword">static</span> <span class="keyword">const</span> u32 Td4[256] =
<a name="l00677"></a>00677 {
<a name="l00678"></a>00678   0x52525252U, 0x09090909U, 0x6a6a6a6aU, 0xd5d5d5d5U,
<a name="l00679"></a>00679   0x30303030U, 0x36363636U, 0xa5a5a5a5U, 0x38383838U,
<a name="l00680"></a>00680   0xbfbfbfbfU, 0x40404040U, 0xa3a3a3a3U, 0x9e9e9e9eU,
<a name="l00681"></a>00681   0x81818181U, 0xf3f3f3f3U, 0xd7d7d7d7U, 0xfbfbfbfbU,
<a name="l00682"></a>00682   0x7c7c7c7cU, 0xe3e3e3e3U, 0x39393939U, 0x82828282U,
<a name="l00683"></a>00683   0x9b9b9b9bU, 0x2f2f2f2fU, 0xffffffffU, 0x87878787U,
<a name="l00684"></a>00684   0x34343434U, 0x8e8e8e8eU, 0x43434343U, 0x44444444U,
<a name="l00685"></a>00685   0xc4c4c4c4U, 0xdedededeU, 0xe9e9e9e9U, 0xcbcbcbcbU,
<a name="l00686"></a>00686   0x54545454U, 0x7b7b7b7bU, 0x94949494U, 0x32323232U,
<a name="l00687"></a>00687   0xa6a6a6a6U, 0xc2c2c2c2U, 0x23232323U, 0x3d3d3d3dU,
<a name="l00688"></a>00688   0xeeeeeeeeU, 0x4c4c4c4cU, 0x95959595U, 0x0b0b0b0bU,
<a name="l00689"></a>00689   0x42424242U, 0xfafafafaU, 0xc3c3c3c3U, 0x4e4e4e4eU,
<a name="l00690"></a>00690   0x08080808U, 0x2e2e2e2eU, 0xa1a1a1a1U, 0x66666666U,
<a name="l00691"></a>00691   0x28282828U, 0xd9d9d9d9U, 0x24242424U, 0xb2b2b2b2U,
<a name="l00692"></a>00692   0x76767676U, 0x5b5b5b5bU, 0xa2a2a2a2U, 0x49494949U,
<a name="l00693"></a>00693   0x6d6d6d6dU, 0x8b8b8b8bU, 0xd1d1d1d1U, 0x25252525U,
<a name="l00694"></a>00694   0x72727272U, 0xf8f8f8f8U, 0xf6f6f6f6U, 0x64646464U,
<a name="l00695"></a>00695   0x86868686U, 0x68686868U, 0x98989898U, 0x16161616U,
<a name="l00696"></a>00696   0xd4d4d4d4U, 0xa4a4a4a4U, 0x5c5c5c5cU, 0xccccccccU,
<a name="l00697"></a>00697   0x5d5d5d5dU, 0x65656565U, 0xb6b6b6b6U, 0x92929292U,
<a name="l00698"></a>00698   0x6c6c6c6cU, 0x70707070U, 0x48484848U, 0x50505050U,
<a name="l00699"></a>00699   0xfdfdfdfdU, 0xededededU, 0xb9b9b9b9U, 0xdadadadaU,
<a name="l00700"></a>00700   0x5e5e5e5eU, 0x15151515U, 0x46464646U, 0x57575757U,
<a name="l00701"></a>00701   0xa7a7a7a7U, 0x8d8d8d8dU, 0x9d9d9d9dU, 0x84848484U,
<a name="l00702"></a>00702   0x90909090U, 0xd8d8d8d8U, 0xababababU, 0x00000000U,
<a name="l00703"></a>00703   0x8c8c8c8cU, 0xbcbcbcbcU, 0xd3d3d3d3U, 0x0a0a0a0aU,
<a name="l00704"></a>00704   0xf7f7f7f7U, 0xe4e4e4e4U, 0x58585858U, 0x05050505U,
<a name="l00705"></a>00705   0xb8b8b8b8U, 0xb3b3b3b3U, 0x45454545U, 0x06060606U,
<a name="l00706"></a>00706   0xd0d0d0d0U, 0x2c2c2c2cU, 0x1e1e1e1eU, 0x8f8f8f8fU,
<a name="l00707"></a>00707   0xcacacacaU, 0x3f3f3f3fU, 0x0f0f0f0fU, 0x02020202U,
<a name="l00708"></a>00708   0xc1c1c1c1U, 0xafafafafU, 0xbdbdbdbdU, 0x03030303U,
<a name="l00709"></a>00709   0x01010101U, 0x13131313U, 0x8a8a8a8aU, 0x6b6b6b6bU,
<a name="l00710"></a>00710   0x3a3a3a3aU, 0x91919191U, 0x11111111U, 0x41414141U,
<a name="l00711"></a>00711   0x4f4f4f4fU, 0x67676767U, 0xdcdcdcdcU, 0xeaeaeaeaU,
<a name="l00712"></a>00712   0x97979797U, 0xf2f2f2f2U, 0xcfcfcfcfU, 0xcecececeU,
<a name="l00713"></a>00713   0xf0f0f0f0U, 0xb4b4b4b4U, 0xe6e6e6e6U, 0x73737373U,
<a name="l00714"></a>00714   0x96969696U, 0xacacacacU, 0x74747474U, 0x22222222U,
<a name="l00715"></a>00715   0xe7e7e7e7U, 0xadadadadU, 0x35353535U, 0x85858585U,
<a name="l00716"></a>00716   0xe2e2e2e2U, 0xf9f9f9f9U, 0x37373737U, 0xe8e8e8e8U,
<a name="l00717"></a>00717   0x1c1c1c1cU, 0x75757575U, 0xdfdfdfdfU, 0x6e6e6e6eU,
<a name="l00718"></a>00718   0x47474747U, 0xf1f1f1f1U, 0x1a1a1a1aU, 0x71717171U,
<a name="l00719"></a>00719   0x1d1d1d1dU, 0x29292929U, 0xc5c5c5c5U, 0x89898989U,
<a name="l00720"></a>00720   0x6f6f6f6fU, 0xb7b7b7b7U, 0x62626262U, 0x0e0e0e0eU,
<a name="l00721"></a>00721   0xaaaaaaaaU, 0x18181818U, 0xbebebebeU, 0x1b1b1b1bU,
<a name="l00722"></a>00722   0xfcfcfcfcU, 0x56565656U, 0x3e3e3e3eU, 0x4b4b4b4bU,
<a name="l00723"></a>00723   0xc6c6c6c6U, 0xd2d2d2d2U, 0x79797979U, 0x20202020U,
<a name="l00724"></a>00724   0x9a9a9a9aU, 0xdbdbdbdbU, 0xc0c0c0c0U, 0xfefefefeU,
<a name="l00725"></a>00725   0x78787878U, 0xcdcdcdcdU, 0x5a5a5a5aU, 0xf4f4f4f4U,
<a name="l00726"></a>00726   0x1f1f1f1fU, 0xddddddddU, 0xa8a8a8a8U, 0x33333333U,
<a name="l00727"></a>00727   0x88888888U, 0x07070707U, 0xc7c7c7c7U, 0x31313131U,
<a name="l00728"></a>00728   0xb1b1b1b1U, 0x12121212U, 0x10101010U, 0x59595959U,
<a name="l00729"></a>00729   0x27272727U, 0x80808080U, 0xececececU, 0x5f5f5f5fU,
<a name="l00730"></a>00730   0x60606060U, 0x51515151U, 0x7f7f7f7fU, 0xa9a9a9a9U,
<a name="l00731"></a>00731   0x19191919U, 0xb5b5b5b5U, 0x4a4a4a4aU, 0x0d0d0d0dU,
<a name="l00732"></a>00732   0x2d2d2d2dU, 0xe5e5e5e5U, 0x7a7a7a7aU, 0x9f9f9f9fU,
<a name="l00733"></a>00733   0x93939393U, 0xc9c9c9c9U, 0x9c9c9c9cU, 0xefefefefU,
<a name="l00734"></a>00734   0xa0a0a0a0U, 0xe0e0e0e0U, 0x3b3b3b3bU, 0x4d4d4d4dU,
<a name="l00735"></a>00735   0xaeaeaeaeU, 0x2a2a2a2aU, 0xf5f5f5f5U, 0xb0b0b0b0U,
<a name="l00736"></a>00736   0xc8c8c8c8U, 0xebebebebU, 0xbbbbbbbbU, 0x3c3c3c3cU,
<a name="l00737"></a>00737   0x83838383U, 0x53535353U, 0x99999999U, 0x61616161U,
<a name="l00738"></a>00738   0x17171717U, 0x2b2b2b2bU, 0x04040404U, 0x7e7e7e7eU,
<a name="l00739"></a>00739   0xbabababaU, 0x77777777U, 0xd6d6d6d6U, 0x26262626U,
<a name="l00740"></a>00740   0xe1e1e1e1U, 0x69696969U, 0x14141414U, 0x63636363U,
<a name="l00741"></a>00741   0x55555555U, 0x21212121U, 0x0c0c0c0cU, 0x7d7d7d7dU,
<a name="l00742"></a>00742 };
<a name="l00743"></a>00743 
<a name="l00744"></a>00744 <span class="keyword">static</span> <span class="keyword">const</span> u32 rcon[] =
<a name="l00745"></a>00745 {
<a name="l00746"></a>00746   0x01000000, 0x02000000, 0x04000000, 0x08000000,
<a name="l00747"></a>00747   0x10000000, 0x20000000, 0x40000000, 0x80000000,
<a name="l00748"></a>00748   0x1B000000, 0x36000000,
<a name="l00749"></a>00749   <span class="comment">/* for 128-bit blocks, Rijndael never uses more than 10 rcon values */</span>
<a name="l00750"></a>00750 };
<a name="l00751"></a>00751 
<a name="l00752"></a>00752 <span class="preprocessor">#define GETU32(plaintext) (((u32)(plaintext)[0] &lt;&lt; 24) ^ \</span>
<a name="l00753"></a>00753 <span class="preprocessor">                    ((u32)(plaintext)[1] &lt;&lt; 16) ^ \</span>
<a name="l00754"></a>00754 <span class="preprocessor">                    ((u32)(plaintext)[2] &lt;&lt;  8) ^ \</span>
<a name="l00755"></a>00755 <span class="preprocessor">                    ((u32)(plaintext)[3]))</span>
<a name="l00756"></a>00756 <span class="preprocessor"></span>
<a name="l00757"></a>00757 <span class="preprocessor">#define PUTU32(ciphertext, st) { (ciphertext)[0] = (u8)((st) &gt;&gt; 24); \</span>
<a name="l00758"></a>00758 <span class="preprocessor">                         (ciphertext)[1] = (u8)((st) &gt;&gt; 16); \</span>
<a name="l00759"></a>00759 <span class="preprocessor">                         (ciphertext)[2] = (u8)((st) &gt;&gt;  8); \</span>
<a name="l00760"></a>00760 <span class="preprocessor">                         (ciphertext)[3] = (u8)(st); }</span>
<a name="l00761"></a>00761 <span class="preprocessor"></span>
<a name="l00762"></a>00762 <span class="comment">/*</span>
<a name="l00763"></a>00763 <span class="comment"> * Expand the cipher key into the encryption key schedule.</span>
<a name="l00764"></a>00764 <span class="comment"> *</span>
<a name="l00765"></a>00765 <span class="comment"> * @return the number of rounds for the given cipher key size.</span>
<a name="l00766"></a>00766 <span class="comment"> */</span>
<a name="l00767"></a>00767 <span class="comment">// static</span>
<a name="l00768"></a>00768 <span class="keywordtype">int</span> Aes_SetupEncrypt(u32 *rk, <span class="keyword">const</span> u8 *key, <span class="keywordtype">int</span> keybits)
<a name="l00769"></a>00769 {
<a name="l00770"></a>00770   <span class="keywordtype">int</span> i = 0;
<a name="l00771"></a>00771   u32 temp;
<a name="l00772"></a>00772 
<a name="l00773"></a>00773   rk[0] = GETU32(key     );
<a name="l00774"></a>00774   rk[1] = GETU32(key +  4);
<a name="l00775"></a>00775   rk[2] = GETU32(key +  8);
<a name="l00776"></a>00776   rk[3] = GETU32(key + 12);
<a name="l00777"></a>00777   <span class="keywordflow">if</span> (keybits == 128)
<a name="l00778"></a>00778   {
<a name="l00779"></a>00779     <span class="keywordflow">for</span> (;;)
<a name="l00780"></a>00780     {
<a name="l00781"></a>00781       temp  = rk[3];
<a name="l00782"></a>00782       rk[4] = rk[0] ^
<a name="l00783"></a>00783         (Te4[(temp &gt;&gt; 16) &amp; 0xff] &amp; 0xff000000) ^
<a name="l00784"></a>00784         (Te4[(temp &gt;&gt;  8) &amp; 0xff] &amp; 0x00ff0000) ^
<a name="l00785"></a>00785         (Te4[(temp      ) &amp; 0xff] &amp; 0x0000ff00) ^
<a name="l00786"></a>00786         (Te4[(temp &gt;&gt; 24)       ] &amp; 0x000000ff) ^
<a name="l00787"></a>00787         rcon[i];
<a name="l00788"></a>00788       rk[5] = rk[1] ^ rk[4];
<a name="l00789"></a>00789       rk[6] = rk[2] ^ rk[5];
<a name="l00790"></a>00790       rk[7] = rk[3] ^ rk[6];
<a name="l00791"></a>00791       <span class="keywordflow">if</span> (++i == 10)
<a name="l00792"></a>00792         <span class="keywordflow">return</span> 10;
<a name="l00793"></a>00793       rk += 4;
<a name="l00794"></a>00794     }
<a name="l00795"></a>00795   }
<a name="l00796"></a>00796   rk[4] = GETU32(key + 16);
<a name="l00797"></a>00797   rk[5] = GETU32(key + 20);
<a name="l00798"></a>00798   <span class="keywordflow">if</span> (keybits == 192)
<a name="l00799"></a>00799   {
<a name="l00800"></a>00800     <span class="keywordflow">for</span> (;;)
<a name="l00801"></a>00801     {
<a name="l00802"></a>00802       temp = rk[ 5];
<a name="l00803"></a>00803       rk[ 6] = rk[ 0] ^
<a name="l00804"></a>00804         (Te4[(temp &gt;&gt; 16) &amp; 0xff] &amp; 0xff000000) ^
<a name="l00805"></a>00805         (Te4[(temp &gt;&gt;  8) &amp; 0xff] &amp; 0x00ff0000) ^
<a name="l00806"></a>00806         (Te4[(temp      ) &amp; 0xff] &amp; 0x0000ff00) ^
<a name="l00807"></a>00807         (Te4[(temp &gt;&gt; 24)       ] &amp; 0x000000ff) ^
<a name="l00808"></a>00808         rcon[i];
<a name="l00809"></a>00809       rk[ 7] = rk[ 1] ^ rk[ 6];
<a name="l00810"></a>00810       rk[ 8] = rk[ 2] ^ rk[ 7];
<a name="l00811"></a>00811       rk[ 9] = rk[ 3] ^ rk[ 8];
<a name="l00812"></a>00812       <span class="keywordflow">if</span> (++i == 8)
<a name="l00813"></a>00813         <span class="keywordflow">return</span> 12;
<a name="l00814"></a>00814       rk[10] = rk[ 4] ^ rk[ 9];
<a name="l00815"></a>00815       rk[11] = rk[ 5] ^ rk[10];
<a name="l00816"></a>00816       rk += 6;
<a name="l00817"></a>00817     }
<a name="l00818"></a>00818   }
<a name="l00819"></a>00819   rk[6] = GETU32(key + 24);
<a name="l00820"></a>00820   rk[7] = GETU32(key + 28);
<a name="l00821"></a>00821   <span class="keywordflow">if</span> (keybits == 256)
<a name="l00822"></a>00822   {
<a name="l00823"></a>00823     <span class="keywordflow">for</span> (;;)
<a name="l00824"></a>00824     {
<a name="l00825"></a>00825       temp = rk[ 7];
<a name="l00826"></a>00826       rk[ 8] = rk[ 0] ^
<a name="l00827"></a>00827         (Te4[(temp &gt;&gt; 16) &amp; 0xff] &amp; 0xff000000) ^
<a name="l00828"></a>00828         (Te4[(temp &gt;&gt;  8) &amp; 0xff] &amp; 0x00ff0000) ^
<a name="l00829"></a>00829         (Te4[(temp      ) &amp; 0xff] &amp; 0x0000ff00) ^
<a name="l00830"></a>00830         (Te4[(temp &gt;&gt; 24)       ] &amp; 0x000000ff) ^
<a name="l00831"></a>00831         rcon[i];
<a name="l00832"></a>00832       rk[ 9] = rk[ 1] ^ rk[ 8];
<a name="l00833"></a>00833       rk[10] = rk[ 2] ^ rk[ 9];
<a name="l00834"></a>00834       rk[11] = rk[ 3] ^ rk[10];
<a name="l00835"></a>00835       <span class="keywordflow">if</span> (++i == 7)
<a name="l00836"></a>00836         <span class="keywordflow">return</span> 14;
<a name="l00837"></a>00837       temp = rk[11];
<a name="l00838"></a>00838       rk[12] = rk[ 4] ^
<a name="l00839"></a>00839         (Te4[(temp &gt;&gt; 24)       ] &amp; 0xff000000) ^
<a name="l00840"></a>00840         (Te4[(temp &gt;&gt; 16) &amp; 0xff] &amp; 0x00ff0000) ^
<a name="l00841"></a>00841         (Te4[(temp &gt;&gt;  8) &amp; 0xff] &amp; 0x0000ff00) ^
<a name="l00842"></a>00842         (Te4[(temp      ) &amp; 0xff] &amp; 0x000000ff);
<a name="l00843"></a>00843       rk[13] = rk[ 5] ^ rk[12];
<a name="l00844"></a>00844       rk[14] = rk[ 6] ^ rk[13];
<a name="l00845"></a>00845       rk[15] = rk[ 7] ^ rk[14];
<a name="l00846"></a>00846       rk += 8;
<a name="l00847"></a>00847     }
<a name="l00848"></a>00848   }
<a name="l00849"></a>00849   <span class="keywordflow">return</span> 0;
<a name="l00850"></a>00850 }
<a name="l00851"></a>00851 
<a name="l00852"></a>00852 <span class="comment">/*</span>
<a name="l00853"></a>00853 <span class="comment"> * Expand the cipher key into the decryption key schedule.</span>
<a name="l00854"></a>00854 <span class="comment"> *</span>
<a name="l00855"></a>00855 <span class="comment"> * @return the number of rounds for the given cipher key size.</span>
<a name="l00856"></a>00856 <span class="comment"> */</span>
<a name="l00857"></a>00857 <span class="comment">// static</span>
<a name="l00858"></a>00858 <span class="keywordtype">int</span> Aes_SetupDecrypt(u32 *rk, <span class="keyword">const</span> u8 *key, <span class="keywordtype">int</span> keybits)
<a name="l00859"></a>00859 {
<a name="l00860"></a>00860   <span class="keywordtype">int</span> nrounds, i, j;
<a name="l00861"></a>00861   u32 temp;
<a name="l00862"></a>00862 
<a name="l00863"></a>00863   <span class="comment">/* expand the cipher key: */</span>
<a name="l00864"></a>00864   nrounds = Aes_SetupEncrypt(rk, key, keybits);
<a name="l00865"></a>00865   <span class="comment">/* invert the order of the round keys: */</span>
<a name="l00866"></a>00866   <span class="keywordflow">for</span> (i = 0, j = 4*nrounds; i &lt; j; i += 4, j -= 4)
<a name="l00867"></a>00867   {
<a name="l00868"></a>00868     temp = rk[i    ]; rk[i    ] = rk[j    ]; rk[j    ] = temp;
<a name="l00869"></a>00869     temp = rk[i + 1]; rk[i + 1] = rk[j + 1]; rk[j + 1] = temp;
<a name="l00870"></a>00870     temp = rk[i + 2]; rk[i + 2] = rk[j + 2]; rk[j + 2] = temp;
<a name="l00871"></a>00871     temp = rk[i + 3]; rk[i + 3] = rk[j + 3]; rk[j + 3] = temp;
<a name="l00872"></a>00872   }
<a name="l00873"></a>00873   <span class="comment">/* apply the inverse MixColumn transform to all round keys but the first and the last: */</span>
<a name="l00874"></a>00874   <span class="keywordflow">for</span> (i = 1; i &lt; nrounds; i++)
<a name="l00875"></a>00875   {
<a name="l00876"></a>00876     rk += 4;
<a name="l00877"></a>00877     rk[0] =
<a name="l00878"></a>00878       Td0[Te4[(rk[0] &gt;&gt; 24)       ] &amp; 0xff] ^
<a name="l00879"></a>00879       Td1[Te4[(rk[0] &gt;&gt; 16) &amp; 0xff] &amp; 0xff] ^
<a name="l00880"></a>00880       Td2[Te4[(rk[0] &gt;&gt;  8) &amp; 0xff] &amp; 0xff] ^
<a name="l00881"></a>00881       Td3[Te4[(rk[0]      ) &amp; 0xff] &amp; 0xff];
<a name="l00882"></a>00882     rk[1] =
<a name="l00883"></a>00883       Td0[Te4[(rk[1] &gt;&gt; 24)       ] &amp; 0xff] ^
<a name="l00884"></a>00884       Td1[Te4[(rk[1] &gt;&gt; 16) &amp; 0xff] &amp; 0xff] ^
<a name="l00885"></a>00885       Td2[Te4[(rk[1] &gt;&gt;  8) &amp; 0xff] &amp; 0xff] ^
<a name="l00886"></a>00886       Td3[Te4[(rk[1]      ) &amp; 0xff] &amp; 0xff];
<a name="l00887"></a>00887     rk[2] =
<a name="l00888"></a>00888       Td0[Te4[(rk[2] &gt;&gt; 24)       ] &amp; 0xff] ^
<a name="l00889"></a>00889       Td1[Te4[(rk[2] &gt;&gt; 16) &amp; 0xff] &amp; 0xff] ^
<a name="l00890"></a>00890       Td2[Te4[(rk[2] &gt;&gt;  8) &amp; 0xff] &amp; 0xff] ^
<a name="l00891"></a>00891       Td3[Te4[(rk[2]      ) &amp; 0xff] &amp; 0xff];
<a name="l00892"></a>00892     rk[3] =
<a name="l00893"></a>00893       Td0[Te4[(rk[3] &gt;&gt; 24)       ] &amp; 0xff] ^
<a name="l00894"></a>00894       Td1[Te4[(rk[3] &gt;&gt; 16) &amp; 0xff] &amp; 0xff] ^
<a name="l00895"></a>00895       Td2[Te4[(rk[3] &gt;&gt;  8) &amp; 0xff] &amp; 0xff] ^
<a name="l00896"></a>00896       Td3[Te4[(rk[3]      ) &amp; 0xff] &amp; 0xff];
<a name="l00897"></a>00897   }
<a name="l00898"></a>00898   <span class="keywordflow">return</span> nrounds;
<a name="l00899"></a>00899 }
<a name="l00900"></a>00900 
<a name="l00901"></a>00901 <span class="comment">/*</span>
<a name="l00902"></a>00902 <span class="comment"> * Expand the cipher key into the decryption key schedule.</span>
<a name="l00903"></a>00903 <span class="comment"> *</span>
<a name="l00904"></a>00904 <span class="comment"> * @return the number of rounds for the given cipher key size.</span>
<a name="l00905"></a>00905 <span class="comment"> */</span>
<a name="l00906"></a>00906 <span class="keywordtype">void</span> Aes_DoEncrypt(<span class="keyword">const</span> u32 *rk, <span class="keywordtype">int</span> nrounds, <span class="keyword">const</span> u8 plaintext[16],
<a name="l00907"></a>00907   u8 ciphertext[16])
<a name="l00908"></a>00908 {
<a name="l00909"></a>00909   u32 s0, s1, s2, s3, t0, t1, t2, t3;
<a name="l00910"></a>00910 <span class="preprocessor">  #ifndef FULL_UNROLL</span>
<a name="l00911"></a>00911 <span class="preprocessor"></span>    <span class="keywordtype">int</span> r;
<a name="l00912"></a>00912 <span class="preprocessor">  #endif </span><span class="comment">/* ?FULL_UNROLL */</span>
<a name="l00913"></a>00913   <span class="comment">/*</span>
<a name="l00914"></a>00914 <span class="comment">   * map byte array block to cipher state</span>
<a name="l00915"></a>00915 <span class="comment">   * and add initial round key:</span>
<a name="l00916"></a>00916 <span class="comment">  */</span>
<a name="l00917"></a>00917   s0 = GETU32(plaintext     ) ^ rk[0];
<a name="l00918"></a>00918   s1 = GETU32(plaintext +  4) ^ rk[1];
<a name="l00919"></a>00919   s2 = GETU32(plaintext +  8) ^ rk[2];
<a name="l00920"></a>00920   s3 = GETU32(plaintext + 12) ^ rk[3];
<a name="l00921"></a>00921 <span class="preprocessor">  #ifdef FULL_UNROLL</span>
<a name="l00922"></a>00922 <span class="preprocessor"></span>    <span class="comment">/* round 1: */</span>
<a name="l00923"></a>00923     t0 = Te0[s0 &gt;&gt; 24] ^ Te1[(s1 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s2 &gt;&gt;  8) &amp; 0xff] ^ Te3[s3 &amp; 0xff] ^ rk[ 4];
<a name="l00924"></a>00924     t1 = Te0[s1 &gt;&gt; 24] ^ Te1[(s2 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s3 &gt;&gt;  8) &amp; 0xff] ^ Te3[s0 &amp; 0xff] ^ rk[ 5];
<a name="l00925"></a>00925     t2 = Te0[s2 &gt;&gt; 24] ^ Te1[(s3 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s0 &gt;&gt;  8) &amp; 0xff] ^ Te3[s1 &amp; 0xff] ^ rk[ 6];
<a name="l00926"></a>00926     t3 = Te0[s3 &gt;&gt; 24] ^ Te1[(s0 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s1 &gt;&gt;  8) &amp; 0xff] ^ Te3[s2 &amp; 0xff] ^ rk[ 7];
<a name="l00927"></a>00927     <span class="comment">/* round 2: */</span>
<a name="l00928"></a>00928     s0 = Te0[t0 &gt;&gt; 24] ^ Te1[(t1 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t2 &gt;&gt;  8) &amp; 0xff] ^ Te3[t3 &amp; 0xff] ^ rk[ 8];
<a name="l00929"></a>00929     s1 = Te0[t1 &gt;&gt; 24] ^ Te1[(t2 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t3 &gt;&gt;  8) &amp; 0xff] ^ Te3[t0 &amp; 0xff] ^ rk[ 9];
<a name="l00930"></a>00930     s2 = Te0[t2 &gt;&gt; 24] ^ Te1[(t3 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t0 &gt;&gt;  8) &amp; 0xff] ^ Te3[t1 &amp; 0xff] ^ rk[10];
<a name="l00931"></a>00931     s3 = Te0[t3 &gt;&gt; 24] ^ Te1[(t0 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t1 &gt;&gt;  8) &amp; 0xff] ^ Te3[t2 &amp; 0xff] ^ rk[11];
<a name="l00932"></a>00932     <span class="comment">/* round 3: */</span>
<a name="l00933"></a>00933     t0 = Te0[s0 &gt;&gt; 24] ^ Te1[(s1 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s2 &gt;&gt;  8) &amp; 0xff] ^ Te3[s3 &amp; 0xff] ^ rk[12];
<a name="l00934"></a>00934     t1 = Te0[s1 &gt;&gt; 24] ^ Te1[(s2 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s3 &gt;&gt;  8) &amp; 0xff] ^ Te3[s0 &amp; 0xff] ^ rk[13];
<a name="l00935"></a>00935     t2 = Te0[s2 &gt;&gt; 24] ^ Te1[(s3 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s0 &gt;&gt;  8) &amp; 0xff] ^ Te3[s1 &amp; 0xff] ^ rk[14];
<a name="l00936"></a>00936     t3 = Te0[s3 &gt;&gt; 24] ^ Te1[(s0 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s1 &gt;&gt;  8) &amp; 0xff] ^ Te3[s2 &amp; 0xff] ^ rk[15];
<a name="l00937"></a>00937     <span class="comment">/* round 4: */</span>
<a name="l00938"></a>00938     s0 = Te0[t0 &gt;&gt; 24] ^ Te1[(t1 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t2 &gt;&gt;  8) &amp; 0xff] ^ Te3[t3 &amp; 0xff] ^ rk[16];
<a name="l00939"></a>00939     s1 = Te0[t1 &gt;&gt; 24] ^ Te1[(t2 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t3 &gt;&gt;  8) &amp; 0xff] ^ Te3[t0 &amp; 0xff] ^ rk[17];
<a name="l00940"></a>00940     s2 = Te0[t2 &gt;&gt; 24] ^ Te1[(t3 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t0 &gt;&gt;  8) &amp; 0xff] ^ Te3[t1 &amp; 0xff] ^ rk[18];
<a name="l00941"></a>00941     s3 = Te0[t3 &gt;&gt; 24] ^ Te1[(t0 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t1 &gt;&gt;  8) &amp; 0xff] ^ Te3[t2 &amp; 0xff] ^ rk[19];
<a name="l00942"></a>00942     <span class="comment">/* round 5: */</span>
<a name="l00943"></a>00943     t0 = Te0[s0 &gt;&gt; 24] ^ Te1[(s1 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s2 &gt;&gt;  8) &amp; 0xff] ^ Te3[s3 &amp; 0xff] ^ rk[20];
<a name="l00944"></a>00944     t1 = Te0[s1 &gt;&gt; 24] ^ Te1[(s2 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s3 &gt;&gt;  8) &amp; 0xff] ^ Te3[s0 &amp; 0xff] ^ rk[21];
<a name="l00945"></a>00945     t2 = Te0[s2 &gt;&gt; 24] ^ Te1[(s3 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s0 &gt;&gt;  8) &amp; 0xff] ^ Te3[s1 &amp; 0xff] ^ rk[22];
<a name="l00946"></a>00946     t3 = Te0[s3 &gt;&gt; 24] ^ Te1[(s0 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s1 &gt;&gt;  8) &amp; 0xff] ^ Te3[s2 &amp; 0xff] ^ rk[23];
<a name="l00947"></a>00947     <span class="comment">/* round 6: */</span>
<a name="l00948"></a>00948     s0 = Te0[t0 &gt;&gt; 24] ^ Te1[(t1 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t2 &gt;&gt;  8) &amp; 0xff] ^ Te3[t3 &amp; 0xff] ^ rk[24];
<a name="l00949"></a>00949     s1 = Te0[t1 &gt;&gt; 24] ^ Te1[(t2 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t3 &gt;&gt;  8) &amp; 0xff] ^ Te3[t0 &amp; 0xff] ^ rk[25];
<a name="l00950"></a>00950     s2 = Te0[t2 &gt;&gt; 24] ^ Te1[(t3 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t0 &gt;&gt;  8) &amp; 0xff] ^ Te3[t1 &amp; 0xff] ^ rk[26];
<a name="l00951"></a>00951     s3 = Te0[t3 &gt;&gt; 24] ^ Te1[(t0 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t1 &gt;&gt;  8) &amp; 0xff] ^ Te3[t2 &amp; 0xff] ^ rk[27];
<a name="l00952"></a>00952     <span class="comment">/* round 7: */</span>
<a name="l00953"></a>00953     t0 = Te0[s0 &gt;&gt; 24] ^ Te1[(s1 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s2 &gt;&gt;  8) &amp; 0xff] ^ Te3[s3 &amp; 0xff] ^ rk[28];
<a name="l00954"></a>00954     t1 = Te0[s1 &gt;&gt; 24] ^ Te1[(s2 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s3 &gt;&gt;  8) &amp; 0xff] ^ Te3[s0 &amp; 0xff] ^ rk[29];
<a name="l00955"></a>00955     t2 = Te0[s2 &gt;&gt; 24] ^ Te1[(s3 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s0 &gt;&gt;  8) &amp; 0xff] ^ Te3[s1 &amp; 0xff] ^ rk[30];
<a name="l00956"></a>00956     t3 = Te0[s3 &gt;&gt; 24] ^ Te1[(s0 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s1 &gt;&gt;  8) &amp; 0xff] ^ Te3[s2 &amp; 0xff] ^ rk[31];
<a name="l00957"></a>00957     <span class="comment">/* round 8: */</span>
<a name="l00958"></a>00958     s0 = Te0[t0 &gt;&gt; 24] ^ Te1[(t1 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t2 &gt;&gt;  8) &amp; 0xff] ^ Te3[t3 &amp; 0xff] ^ rk[32];
<a name="l00959"></a>00959     s1 = Te0[t1 &gt;&gt; 24] ^ Te1[(t2 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t3 &gt;&gt;  8) &amp; 0xff] ^ Te3[t0 &amp; 0xff] ^ rk[33];
<a name="l00960"></a>00960     s2 = Te0[t2 &gt;&gt; 24] ^ Te1[(t3 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t0 &gt;&gt;  8) &amp; 0xff] ^ Te3[t1 &amp; 0xff] ^ rk[34];
<a name="l00961"></a>00961     s3 = Te0[t3 &gt;&gt; 24] ^ Te1[(t0 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t1 &gt;&gt;  8) &amp; 0xff] ^ Te3[t2 &amp; 0xff] ^ rk[35];
<a name="l00962"></a>00962     <span class="comment">/* round 9: */</span>
<a name="l00963"></a>00963     t0 = Te0[s0 &gt;&gt; 24] ^ Te1[(s1 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s2 &gt;&gt;  8) &amp; 0xff] ^ Te3[s3 &amp; 0xff] ^ rk[36];
<a name="l00964"></a>00964     t1 = Te0[s1 &gt;&gt; 24] ^ Te1[(s2 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s3 &gt;&gt;  8) &amp; 0xff] ^ Te3[s0 &amp; 0xff] ^ rk[37];
<a name="l00965"></a>00965     t2 = Te0[s2 &gt;&gt; 24] ^ Te1[(s3 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s0 &gt;&gt;  8) &amp; 0xff] ^ Te3[s1 &amp; 0xff] ^ rk[38];
<a name="l00966"></a>00966     t3 = Te0[s3 &gt;&gt; 24] ^ Te1[(s0 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s1 &gt;&gt;  8) &amp; 0xff] ^ Te3[s2 &amp; 0xff] ^ rk[39];
<a name="l00967"></a>00967     <span class="keywordflow">if</span> (nrounds &gt; 10)
<a name="l00968"></a>00968     {
<a name="l00969"></a>00969       <span class="comment">/* round 10: */</span>
<a name="l00970"></a>00970       s0 = Te0[t0 &gt;&gt; 24] ^ Te1[(t1 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t2 &gt;&gt;  8) &amp; 0xff] ^ Te3[t3 &amp; 0xff] ^ rk[40];
<a name="l00971"></a>00971       s1 = Te0[t1 &gt;&gt; 24] ^ Te1[(t2 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t3 &gt;&gt;  8) &amp; 0xff] ^ Te3[t0 &amp; 0xff] ^ rk[41];
<a name="l00972"></a>00972       s2 = Te0[t2 &gt;&gt; 24] ^ Te1[(t3 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t0 &gt;&gt;  8) &amp; 0xff] ^ Te3[t1 &amp; 0xff] ^ rk[42];
<a name="l00973"></a>00973       s3 = Te0[t3 &gt;&gt; 24] ^ Te1[(t0 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t1 &gt;&gt;  8) &amp; 0xff] ^ Te3[t2 &amp; 0xff] ^ rk[43];
<a name="l00974"></a>00974       <span class="comment">/* round 11: */</span>
<a name="l00975"></a>00975       t0 = Te0[s0 &gt;&gt; 24] ^ Te1[(s1 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s2 &gt;&gt;  8) &amp; 0xff] ^ Te3[s3 &amp; 0xff] ^ rk[44];
<a name="l00976"></a>00976       t1 = Te0[s1 &gt;&gt; 24] ^ Te1[(s2 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s3 &gt;&gt;  8) &amp; 0xff] ^ Te3[s0 &amp; 0xff] ^ rk[45];
<a name="l00977"></a>00977       t2 = Te0[s2 &gt;&gt; 24] ^ Te1[(s3 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s0 &gt;&gt;  8) &amp; 0xff] ^ Te3[s1 &amp; 0xff] ^ rk[46];
<a name="l00978"></a>00978       t3 = Te0[s3 &gt;&gt; 24] ^ Te1[(s0 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s1 &gt;&gt;  8) &amp; 0xff] ^ Te3[s2 &amp; 0xff] ^ rk[47];
<a name="l00979"></a>00979       <span class="keywordflow">if</span> (nrounds &gt; 12)
<a name="l00980"></a>00980       {
<a name="l00981"></a>00981         <span class="comment">/* round 12: */</span>
<a name="l00982"></a>00982         s0 = Te0[t0 &gt;&gt; 24] ^ Te1[(t1 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t2 &gt;&gt;  8) &amp; 0xff] ^ Te3[t3 &amp; 0xff] ^ rk[48];
<a name="l00983"></a>00983         s1 = Te0[t1 &gt;&gt; 24] ^ Te1[(t2 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t3 &gt;&gt;  8) &amp; 0xff] ^ Te3[t0 &amp; 0xff] ^ rk[49];
<a name="l00984"></a>00984         s2 = Te0[t2 &gt;&gt; 24] ^ Te1[(t3 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t0 &gt;&gt;  8) &amp; 0xff] ^ Te3[t1 &amp; 0xff] ^ rk[50];
<a name="l00985"></a>00985         s3 = Te0[t3 &gt;&gt; 24] ^ Te1[(t0 &gt;&gt; 16) &amp; 0xff] ^ Te2[(t1 &gt;&gt;  8) &amp; 0xff] ^ Te3[t2 &amp; 0xff] ^ rk[51];
<a name="l00986"></a>00986         <span class="comment">/* round 13: */</span>
<a name="l00987"></a>00987         t0 = Te0[s0 &gt;&gt; 24] ^ Te1[(s1 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s2 &gt;&gt;  8) &amp; 0xff] ^ Te3[s3 &amp; 0xff] ^ rk[52];
<a name="l00988"></a>00988         t1 = Te0[s1 &gt;&gt; 24] ^ Te1[(s2 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s3 &gt;&gt;  8) &amp; 0xff] ^ Te3[s0 &amp; 0xff] ^ rk[53];
<a name="l00989"></a>00989         t2 = Te0[s2 &gt;&gt; 24] ^ Te1[(s3 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s0 &gt;&gt;  8) &amp; 0xff] ^ Te3[s1 &amp; 0xff] ^ rk[54];
<a name="l00990"></a>00990         t3 = Te0[s3 &gt;&gt; 24] ^ Te1[(s0 &gt;&gt; 16) &amp; 0xff] ^ Te2[(s1 &gt;&gt;  8) &amp; 0xff] ^ Te3[s2 &amp; 0xff] ^ rk[55];
<a name="l00991"></a>00991       }
<a name="l00992"></a>00992     }
<a name="l00993"></a>00993     rk += nrounds &lt;&lt; 2;
<a name="l00994"></a>00994 <span class="preprocessor">  #else  </span><span class="comment">/* !FULL_UNROLL */</span>
<a name="l00995"></a>00995     <span class="comment">/*</span>
<a name="l00996"></a>00996 <span class="comment">    * nrounds - 1 full rounds:</span>
<a name="l00997"></a>00997 <span class="comment">    */</span>
<a name="l00998"></a>00998     r = nrounds &gt;&gt; 1;
<a name="l00999"></a>00999     <span class="keywordflow">for</span> (;;)
<a name="l01000"></a>01000     {
<a name="l01001"></a>01001       t0 =
<a name="l01002"></a>01002         Te0[(s0 &gt;&gt; 24)       ] ^
<a name="l01003"></a>01003         Te1[(s1 &gt;&gt; 16) &amp; 0xff] ^
<a name="l01004"></a>01004         Te2[(s2 &gt;&gt;  8) &amp; 0xff] ^
<a name="l01005"></a>01005         Te3[(s3      ) &amp; 0xff] ^
<a name="l01006"></a>01006         rk[4];
<a name="l01007"></a>01007       t1 =
<a name="l01008"></a>01008         Te0[(s1 &gt;&gt; 24)       ] ^
<a name="l01009"></a>01009         Te1[(s2 &gt;&gt; 16) &amp; 0xff] ^
<a name="l01010"></a>01010         Te2[(s3 &gt;&gt;  8) &amp; 0xff] ^
<a name="l01011"></a>01011         Te3[(s0      ) &amp; 0xff] ^
<a name="l01012"></a>01012         rk[5];
<a name="l01013"></a>01013       t2 =
<a name="l01014"></a>01014         Te0[(s2 &gt;&gt; 24)       ] ^
<a name="l01015"></a>01015         Te1[(s3 &gt;&gt; 16) &amp; 0xff] ^
<a name="l01016"></a>01016         Te2[(s0 &gt;&gt;  8) &amp; 0xff] ^
<a name="l01017"></a>01017         Te3[(s1      ) &amp; 0xff] ^
<a name="l01018"></a>01018         rk[6];
<a name="l01019"></a>01019       t3 =
<a name="l01020"></a>01020         Te0[(s3 &gt;&gt; 24)       ] ^
<a name="l01021"></a>01021         Te1[(s0 &gt;&gt; 16) &amp; 0xff] ^
<a name="l01022"></a>01022         Te2[(s1 &gt;&gt;  8) &amp; 0xff] ^
<a name="l01023"></a>01023         Te3[(s2      ) &amp; 0xff] ^
<a name="l01024"></a>01024         rk[7];
<a name="l01025"></a>01025         rk += 8;
<a name="l01026"></a>01026         <span class="keywordflow">if</span> (--r == 0)
<a name="l01027"></a>01027             <span class="keywordflow">break</span>;
<a name="l01028"></a>01028       s0 =
<a name="l01029"></a>01029         Te0[(t0 &gt;&gt; 24)       ] ^
<a name="l01030"></a>01030         Te1[(t1 &gt;&gt; 16) &amp; 0xff] ^
<a name="l01031"></a>01031         Te2[(t2 &gt;&gt;  8) &amp; 0xff] ^
<a name="l01032"></a>01032         Te3[(t3      ) &amp; 0xff] ^
<a name="l01033"></a>01033         rk[0];
<a name="l01034"></a>01034       s1 =
<a name="l01035"></a>01035         Te0[(t1 &gt;&gt; 24)       ] ^
<a name="l01036"></a>01036         Te1[(t2 &gt;&gt; 16) &amp; 0xff] ^
<a name="l01037"></a>01037         Te2[(t3 &gt;&gt;  8) &amp; 0xff] ^
<a name="l01038"></a>01038         Te3[(t0      ) &amp; 0xff] ^
<a name="l01039"></a>01039         rk[1];
<a name="l01040"></a>01040       s2 =
<a name="l01041"></a>01041         Te0[(t2 &gt;&gt; 24)       ] ^
<a name="l01042"></a>01042         Te1[(t3 &gt;&gt; 16) &amp; 0xff] ^
<a name="l01043"></a>01043         Te2[(t0 &gt;&gt;  8) &amp; 0xff] ^
<a name="l01044"></a>01044         Te3[(t1      ) &amp; 0xff] ^
<a name="l01045"></a>01045         rk[2];
<a name="l01046"></a>01046       s3 =
<a name="l01047"></a>01047         Te0[(t3 &gt;&gt; 24)       ] ^
<a name="l01048"></a>01048         Te1[(t0 &gt;&gt; 16) &amp; 0xff] ^
<a name="l01049"></a>01049         Te2[(t1 &gt;&gt;  8) &amp; 0xff] ^
<a name="l01050"></a>01050         Te3[(t2      ) &amp; 0xff] ^
<a name="l01051"></a>01051         rk[3];
<a name="l01052"></a>01052      }
<a name="l01053"></a>01053 <span class="preprocessor"> #endif </span><span class="comment">/* ?FULL_UNROLL */</span>
<a name="l01054"></a>01054   <span class="comment">/*</span>
<a name="l01055"></a>01055 <span class="comment">  * apply last round and</span>
<a name="l01056"></a>01056 <span class="comment">  * map cipher state to byte array block:</span>
<a name="l01057"></a>01057 <span class="comment">  */</span>
<a name="l01058"></a>01058   s0 =
<a name="l01059"></a>01059     (Te4[(t0 &gt;&gt; 24)       ] &amp; 0xff000000) ^
<a name="l01060"></a>01060     (Te4[(t1 &gt;&gt; 16) &amp; 0xff] &amp; 0x00ff0000) ^
<a name="l01061"></a>01061     (Te4[(t2 &gt;&gt;  8) &amp; 0xff] &amp; 0x0000ff00) ^
<a name="l01062"></a>01062     (Te4[(t3      ) &amp; 0xff] &amp; 0x000000ff) ^
<a name="l01063"></a>01063     rk[0];
<a name="l01064"></a>01064   PUTU32(ciphertext     , s0);
<a name="l01065"></a>01065   s1 =
<a name="l01066"></a>01066     (Te4[(t1 &gt;&gt; 24)       ] &amp; 0xff000000) ^
<a name="l01067"></a>01067     (Te4[(t2 &gt;&gt; 16) &amp; 0xff] &amp; 0x00ff0000) ^
<a name="l01068"></a>01068     (Te4[(t3 &gt;&gt;  8) &amp; 0xff] &amp; 0x0000ff00) ^
<a name="l01069"></a>01069     (Te4[(t0      ) &amp; 0xff] &amp; 0x000000ff) ^
<a name="l01070"></a>01070     rk[1];
<a name="l01071"></a>01071   PUTU32(ciphertext +  4, s1);
<a name="l01072"></a>01072   s2 =
<a name="l01073"></a>01073     (Te4[(t2 &gt;&gt; 24)       ] &amp; 0xff000000) ^
<a name="l01074"></a>01074     (Te4[(t3 &gt;&gt; 16) &amp; 0xff] &amp; 0x00ff0000) ^
<a name="l01075"></a>01075     (Te4[(t0 &gt;&gt;  8) &amp; 0xff] &amp; 0x0000ff00) ^
<a name="l01076"></a>01076     (Te4[(t1      ) &amp; 0xff] &amp; 0x000000ff) ^
<a name="l01077"></a>01077     rk[2];
<a name="l01078"></a>01078   PUTU32(ciphertext +  8, s2);
<a name="l01079"></a>01079   s3 =
<a name="l01080"></a>01080     (Te4[(t3 &gt;&gt; 24)       ] &amp; 0xff000000) ^
<a name="l01081"></a>01081     (Te4[(t0 &gt;&gt; 16) &amp; 0xff] &amp; 0x00ff0000) ^
<a name="l01082"></a>01082     (Te4[(t1 &gt;&gt;  8) &amp; 0xff] &amp; 0x0000ff00) ^
<a name="l01083"></a>01083     (Te4[(t2      ) &amp; 0xff] &amp; 0x000000ff) ^
<a name="l01084"></a>01084     rk[3];
<a name="l01085"></a>01085   PUTU32(ciphertext + 12, s3);
<a name="l01086"></a>01086 }
<a name="l01087"></a>01087 
<a name="l01088"></a>01088 <span class="comment">// static</span>
<a name="l01089"></a>01089 <span class="keywordtype">void</span> Aes_DoDecrypt(<span class="keyword">const</span> u32 *rk, <span class="keywordtype">int</span> nrounds, <span class="keyword">const</span> u8 ciphertext[16],
<a name="l01090"></a>01090   u8 plaintext[16])
<a name="l01091"></a>01091 {
<a name="l01092"></a>01092   u32 s0, s1, s2, s3, t0, t1, t2, t3;
<a name="l01093"></a>01093 <span class="preprocessor">  #ifndef FULL_UNROLL</span>
<a name="l01094"></a>01094 <span class="preprocessor"></span>    <span class="keywordtype">int</span> r;
<a name="l01095"></a>01095 <span class="preprocessor">  #endif </span><span class="comment">/* ?FULL_UNROLL */</span>
<a name="l01096"></a>01096 
<a name="l01097"></a>01097   <span class="comment">/*</span>
<a name="l01098"></a>01098 <span class="comment">  * map byte array block to cipher state</span>
<a name="l01099"></a>01099 <span class="comment">  * and add initial round key:</span>
<a name="l01100"></a>01100 <span class="comment">  */</span>
<a name="l01101"></a>01101     s0 = GETU32(ciphertext     ) ^ rk[0];
<a name="l01102"></a>01102     s1 = GETU32(ciphertext +  4) ^ rk[1];
<a name="l01103"></a>01103     s2 = GETU32(ciphertext +  8) ^ rk[2];
<a name="l01104"></a>01104     s3 = GETU32(ciphertext + 12) ^ rk[3];
<a name="l01105"></a>01105 <span class="preprocessor">  #ifdef FULL_UNROLL</span>
<a name="l01106"></a>01106 <span class="preprocessor"></span>    <span class="comment">/* round 1: */</span>
<a name="l01107"></a>01107     t0 = Td0[s0 &gt;&gt; 24] ^ Td1[(s3 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s2 &gt;&gt;  8) &amp; 0xff] ^ Td3[s1 &amp; 0xff] ^ rk[ 4];
<a name="l01108"></a>01108     t1 = Td0[s1 &gt;&gt; 24] ^ Td1[(s0 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s3 &gt;&gt;  8) &amp; 0xff] ^ Td3[s2 &amp; 0xff] ^ rk[ 5];
<a name="l01109"></a>01109     t2 = Td0[s2 &gt;&gt; 24] ^ Td1[(s1 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s0 &gt;&gt;  8) &amp; 0xff] ^ Td3[s3 &amp; 0xff] ^ rk[ 6];
<a name="l01110"></a>01110     t3 = Td0[s3 &gt;&gt; 24] ^ Td1[(s2 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s1 &gt;&gt;  8) &amp; 0xff] ^ Td3[s0 &amp; 0xff] ^ rk[ 7];
<a name="l01111"></a>01111     <span class="comment">/* round 2: */</span>
<a name="l01112"></a>01112     s0 = Td0[t0 &gt;&gt; 24] ^ Td1[(t3 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t2 &gt;&gt;  8) &amp; 0xff] ^ Td3[t1 &amp; 0xff] ^ rk[ 8];
<a name="l01113"></a>01113     s1 = Td0[t1 &gt;&gt; 24] ^ Td1[(t0 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t3 &gt;&gt;  8) &amp; 0xff] ^ Td3[t2 &amp; 0xff] ^ rk[ 9];
<a name="l01114"></a>01114     s2 = Td0[t2 &gt;&gt; 24] ^ Td1[(t1 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t0 &gt;&gt;  8) &amp; 0xff] ^ Td3[t3 &amp; 0xff] ^ rk[10];
<a name="l01115"></a>01115     s3 = Td0[t3 &gt;&gt; 24] ^ Td1[(t2 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t1 &gt;&gt;  8) &amp; 0xff] ^ Td3[t0 &amp; 0xff] ^ rk[11];
<a name="l01116"></a>01116     <span class="comment">/* round 3: */</span>
<a name="l01117"></a>01117     t0 = Td0[s0 &gt;&gt; 24] ^ Td1[(s3 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s2 &gt;&gt;  8) &amp; 0xff] ^ Td3[s1 &amp; 0xff] ^ rk[12];
<a name="l01118"></a>01118     t1 = Td0[s1 &gt;&gt; 24] ^ Td1[(s0 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s3 &gt;&gt;  8) &amp; 0xff] ^ Td3[s2 &amp; 0xff] ^ rk[13];
<a name="l01119"></a>01119     t2 = Td0[s2 &gt;&gt; 24] ^ Td1[(s1 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s0 &gt;&gt;  8) &amp; 0xff] ^ Td3[s3 &amp; 0xff] ^ rk[14];
<a name="l01120"></a>01120     t3 = Td0[s3 &gt;&gt; 24] ^ Td1[(s2 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s1 &gt;&gt;  8) &amp; 0xff] ^ Td3[s0 &amp; 0xff] ^ rk[15];
<a name="l01121"></a>01121     <span class="comment">/* round 4: */</span>
<a name="l01122"></a>01122     s0 = Td0[t0 &gt;&gt; 24] ^ Td1[(t3 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t2 &gt;&gt;  8) &amp; 0xff] ^ Td3[t1 &amp; 0xff] ^ rk[16];
<a name="l01123"></a>01123     s1 = Td0[t1 &gt;&gt; 24] ^ Td1[(t0 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t3 &gt;&gt;  8) &amp; 0xff] ^ Td3[t2 &amp; 0xff] ^ rk[17];
<a name="l01124"></a>01124     s2 = Td0[t2 &gt;&gt; 24] ^ Td1[(t1 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t0 &gt;&gt;  8) &amp; 0xff] ^ Td3[t3 &amp; 0xff] ^ rk[18];
<a name="l01125"></a>01125     s3 = Td0[t3 &gt;&gt; 24] ^ Td1[(t2 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t1 &gt;&gt;  8) &amp; 0xff] ^ Td3[t0 &amp; 0xff] ^ rk[19];
<a name="l01126"></a>01126     <span class="comment">/* round 5: */</span>
<a name="l01127"></a>01127     t0 = Td0[s0 &gt;&gt; 24] ^ Td1[(s3 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s2 &gt;&gt;  8) &amp; 0xff] ^ Td3[s1 &amp; 0xff] ^ rk[20];
<a name="l01128"></a>01128     t1 = Td0[s1 &gt;&gt; 24] ^ Td1[(s0 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s3 &gt;&gt;  8) &amp; 0xff] ^ Td3[s2 &amp; 0xff] ^ rk[21];
<a name="l01129"></a>01129     t2 = Td0[s2 &gt;&gt; 24] ^ Td1[(s1 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s0 &gt;&gt;  8) &amp; 0xff] ^ Td3[s3 &amp; 0xff] ^ rk[22];
<a name="l01130"></a>01130     t3 = Td0[s3 &gt;&gt; 24] ^ Td1[(s2 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s1 &gt;&gt;  8) &amp; 0xff] ^ Td3[s0 &amp; 0xff] ^ rk[23];
<a name="l01131"></a>01131     <span class="comment">/* round 6: */</span>
<a name="l01132"></a>01132     s0 = Td0[t0 &gt;&gt; 24] ^ Td1[(t3 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t2 &gt;&gt;  8) &amp; 0xff] ^ Td3[t1 &amp; 0xff] ^ rk[24];
<a name="l01133"></a>01133     s1 = Td0[t1 &gt;&gt; 24] ^ Td1[(t0 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t3 &gt;&gt;  8) &amp; 0xff] ^ Td3[t2 &amp; 0xff] ^ rk[25];
<a name="l01134"></a>01134     s2 = Td0[t2 &gt;&gt; 24] ^ Td1[(t1 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t0 &gt;&gt;  8) &amp; 0xff] ^ Td3[t3 &amp; 0xff] ^ rk[26];
<a name="l01135"></a>01135     s3 = Td0[t3 &gt;&gt; 24] ^ Td1[(t2 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t1 &gt;&gt;  8) &amp; 0xff] ^ Td3[t0 &amp; 0xff] ^ rk[27];
<a name="l01136"></a>01136     <span class="comment">/* round 7: */</span>
<a name="l01137"></a>01137     t0 = Td0[s0 &gt;&gt; 24] ^ Td1[(s3 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s2 &gt;&gt;  8) &amp; 0xff] ^ Td3[s1 &amp; 0xff] ^ rk[28];
<a name="l01138"></a>01138     t1 = Td0[s1 &gt;&gt; 24] ^ Td1[(s0 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s3 &gt;&gt;  8) &amp; 0xff] ^ Td3[s2 &amp; 0xff] ^ rk[29];
<a name="l01139"></a>01139     t2 = Td0[s2 &gt;&gt; 24] ^ Td1[(s1 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s0 &gt;&gt;  8) &amp; 0xff] ^ Td3[s3 &amp; 0xff] ^ rk[30];
<a name="l01140"></a>01140     t3 = Td0[s3 &gt;&gt; 24] ^ Td1[(s2 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s1 &gt;&gt;  8) &amp; 0xff] ^ Td3[s0 &amp; 0xff] ^ rk[31];
<a name="l01141"></a>01141     <span class="comment">/* round 8: */</span>
<a name="l01142"></a>01142     s0 = Td0[t0 &gt;&gt; 24] ^ Td1[(t3 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t2 &gt;&gt;  8) &amp; 0xff] ^ Td3[t1 &amp; 0xff] ^ rk[32];
<a name="l01143"></a>01143     s1 = Td0[t1 &gt;&gt; 24] ^ Td1[(t0 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t3 &gt;&gt;  8) &amp; 0xff] ^ Td3[t2 &amp; 0xff] ^ rk[33];
<a name="l01144"></a>01144     s2 = Td0[t2 &gt;&gt; 24] ^ Td1[(t1 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t0 &gt;&gt;  8) &amp; 0xff] ^ Td3[t3 &amp; 0xff] ^ rk[34];
<a name="l01145"></a>01145     s3 = Td0[t3 &gt;&gt; 24] ^ Td1[(t2 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t1 &gt;&gt;  8) &amp; 0xff] ^ Td3[t0 &amp; 0xff] ^ rk[35];
<a name="l01146"></a>01146     <span class="comment">/* round 9: */</span>
<a name="l01147"></a>01147     t0 = Td0[s0 &gt;&gt; 24] ^ Td1[(s3 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s2 &gt;&gt;  8) &amp; 0xff] ^ Td3[s1 &amp; 0xff] ^ rk[36];
<a name="l01148"></a>01148     t1 = Td0[s1 &gt;&gt; 24] ^ Td1[(s0 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s3 &gt;&gt;  8) &amp; 0xff] ^ Td3[s2 &amp; 0xff] ^ rk[37];
<a name="l01149"></a>01149     t2 = Td0[s2 &gt;&gt; 24] ^ Td1[(s1 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s0 &gt;&gt;  8) &amp; 0xff] ^ Td3[s3 &amp; 0xff] ^ rk[38];
<a name="l01150"></a>01150     t3 = Td0[s3 &gt;&gt; 24] ^ Td1[(s2 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s1 &gt;&gt;  8) &amp; 0xff] ^ Td3[s0 &amp; 0xff] ^ rk[39];
<a name="l01151"></a>01151     <span class="keywordflow">if</span> (nrounds &gt; 10)
<a name="l01152"></a>01152     {
<a name="l01153"></a>01153       <span class="comment">/* round 10: */</span>
<a name="l01154"></a>01154       s0 = Td0[t0 &gt;&gt; 24] ^ Td1[(t3 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t2 &gt;&gt;  8) &amp; 0xff] ^ Td3[t1 &amp; 0xff] ^ rk[40];
<a name="l01155"></a>01155       s1 = Td0[t1 &gt;&gt; 24] ^ Td1[(t0 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t3 &gt;&gt;  8) &amp; 0xff] ^ Td3[t2 &amp; 0xff] ^ rk[41];
<a name="l01156"></a>01156       s2 = Td0[t2 &gt;&gt; 24] ^ Td1[(t1 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t0 &gt;&gt;  8) &amp; 0xff] ^ Td3[t3 &amp; 0xff] ^ rk[42];
<a name="l01157"></a>01157       s3 = Td0[t3 &gt;&gt; 24] ^ Td1[(t2 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t1 &gt;&gt;  8) &amp; 0xff] ^ Td3[t0 &amp; 0xff] ^ rk[43];
<a name="l01158"></a>01158       <span class="comment">/* round 11: */</span>
<a name="l01159"></a>01159       t0 = Td0[s0 &gt;&gt; 24] ^ Td1[(s3 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s2 &gt;&gt;  8) &amp; 0xff] ^ Td3[s1 &amp; 0xff] ^ rk[44];
<a name="l01160"></a>01160       t1 = Td0[s1 &gt;&gt; 24] ^ Td1[(s0 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s3 &gt;&gt;  8) &amp; 0xff] ^ Td3[s2 &amp; 0xff] ^ rk[45];
<a name="l01161"></a>01161       t2 = Td0[s2 &gt;&gt; 24] ^ Td1[(s1 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s0 &gt;&gt;  8) &amp; 0xff] ^ Td3[s3 &amp; 0xff] ^ rk[46];
<a name="l01162"></a>01162       t3 = Td0[s3 &gt;&gt; 24] ^ Td1[(s2 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s1 &gt;&gt;  8) &amp; 0xff] ^ Td3[s0 &amp; 0xff] ^ rk[47];
<a name="l01163"></a>01163       <span class="keywordflow">if</span> (nrounds &gt; 12)
<a name="l01164"></a>01164       {
<a name="l01165"></a>01165         <span class="comment">/* round 12: */</span>
<a name="l01166"></a>01166         s0 = Td0[t0 &gt;&gt; 24] ^ Td1[(t3 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t2 &gt;&gt;  8) &amp; 0xff] ^ Td3[t1 &amp; 0xff] ^ rk[48];
<a name="l01167"></a>01167         s1 = Td0[t1 &gt;&gt; 24] ^ Td1[(t0 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t3 &gt;&gt;  8) &amp; 0xff] ^ Td3[t2 &amp; 0xff] ^ rk[49];
<a name="l01168"></a>01168         s2 = Td0[t2 &gt;&gt; 24] ^ Td1[(t1 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t0 &gt;&gt;  8) &amp; 0xff] ^ Td3[t3 &amp; 0xff] ^ rk[50];
<a name="l01169"></a>01169         s3 = Td0[t3 &gt;&gt; 24] ^ Td1[(t2 &gt;&gt; 16) &amp; 0xff] ^ Td2[(t1 &gt;&gt;  8) &amp; 0xff] ^ Td3[t0 &amp; 0xff] ^ rk[51];
<a name="l01170"></a>01170         <span class="comment">/* round 13: */</span>
<a name="l01171"></a>01171         t0 = Td0[s0 &gt;&gt; 24] ^ Td1[(s3 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s2 &gt;&gt;  8) &amp; 0xff] ^ Td3[s1 &amp; 0xff] ^ rk[52];
<a name="l01172"></a>01172         t1 = Td0[s1 &gt;&gt; 24] ^ Td1[(s0 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s3 &gt;&gt;  8) &amp; 0xff] ^ Td3[s2 &amp; 0xff] ^ rk[53];
<a name="l01173"></a>01173         t2 = Td0[s2 &gt;&gt; 24] ^ Td1[(s1 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s0 &gt;&gt;  8) &amp; 0xff] ^ Td3[s3 &amp; 0xff] ^ rk[54];
<a name="l01174"></a>01174         t3 = Td0[s3 &gt;&gt; 24] ^ Td1[(s2 &gt;&gt; 16) &amp; 0xff] ^ Td2[(s1 &gt;&gt;  8) &amp; 0xff] ^ Td3[s0 &amp; 0xff] ^ rk[55];
<a name="l01175"></a>01175       }
<a name="l01176"></a>01176     }
<a name="l01177"></a>01177     rk += nrounds &lt;&lt; 2;
<a name="l01178"></a>01178 <span class="preprocessor">  #else  </span><span class="comment">/* !FULL_UNROLL */</span>
<a name="l01179"></a>01179     <span class="comment">/*</span>
<a name="l01180"></a>01180 <span class="comment">    * nrounds - 1 full rounds:</span>
<a name="l01181"></a>01181 <span class="comment">    */</span>
<a name="l01182"></a>01182     r = nrounds &gt;&gt; 1;
<a name="l01183"></a>01183     <span class="keywordflow">for</span> (;;)
<a name="l01184"></a>01184     {
<a name="l01185"></a>01185       t0 =
<a name="l01186"></a>01186         Td0[(s0 &gt;&gt; 24)       ] ^
<a name="l01187"></a>01187         Td1[(s3 &gt;&gt; 16) &amp; 0xff] ^
<a name="l01188"></a>01188         Td2[(s2 &gt;&gt;  8) &amp; 0xff] ^
<a name="l01189"></a>01189         Td3[(s1      ) &amp; 0xff] ^
<a name="l01190"></a>01190         rk[4];
<a name="l01191"></a>01191       t1 =
<a name="l01192"></a>01192         Td0[(s1 &gt;&gt; 24)       ] ^
<a name="l01193"></a>01193         Td1[(s0 &gt;&gt; 16) &amp; 0xff] ^
<a name="l01194"></a>01194         Td2[(s3 &gt;&gt;  8) &amp; 0xff] ^
<a name="l01195"></a>01195         Td3[(s2      ) &amp; 0xff] ^
<a name="l01196"></a>01196         rk[5];
<a name="l01197"></a>01197       t2 =
<a name="l01198"></a>01198         Td0[(s2 &gt;&gt; 24)       ] ^
<a name="l01199"></a>01199         Td1[(s1 &gt;&gt; 16) &amp; 0xff] ^
<a name="l01200"></a>01200         Td2[(s0 &gt;&gt;  8) &amp; 0xff] ^
<a name="l01201"></a>01201         Td3[(s3      ) &amp; 0xff] ^
<a name="l01202"></a>01202         rk[6];
<a name="l01203"></a>01203       t3 =
<a name="l01204"></a>01204         Td0[(s3 &gt;&gt; 24)       ] ^
<a name="l01205"></a>01205         Td1[(s2 &gt;&gt; 16) &amp; 0xff] ^
<a name="l01206"></a>01206         Td2[(s1 &gt;&gt;  8) &amp; 0xff] ^
<a name="l01207"></a>01207         Td3[(s0      ) &amp; 0xff] ^
<a name="l01208"></a>01208         rk[7];
<a name="l01209"></a>01209       rk += 8;
<a name="l01210"></a>01210       <span class="keywordflow">if</span> (--r == 0)
<a name="l01211"></a>01211           <span class="keywordflow">break</span>;
<a name="l01212"></a>01212       s0 =
<a name="l01213"></a>01213         Td0[(t0 &gt;&gt; 24)       ] ^
<a name="l01214"></a>01214         Td1[(t3 &gt;&gt; 16) &amp; 0xff] ^
<a name="l01215"></a>01215         Td2[(t2 &gt;&gt;  8) &amp; 0xff] ^
<a name="l01216"></a>01216         Td3[(t1      ) &amp; 0xff] ^
<a name="l01217"></a>01217         rk[0];
<a name="l01218"></a>01218       s1 =
<a name="l01219"></a>01219         Td0[(t1 &gt;&gt; 24)       ] ^
<a name="l01220"></a>01220         Td1[(t0 &gt;&gt; 16) &amp; 0xff] ^
<a name="l01221"></a>01221         Td2[(t3 &gt;&gt;  8) &amp; 0xff] ^
<a name="l01222"></a>01222         Td3[(t2      ) &amp; 0xff] ^
<a name="l01223"></a>01223         rk[1];
<a name="l01224"></a>01224       s2 =
<a name="l01225"></a>01225         Td0[(t2 &gt;&gt; 24)       ] ^
<a name="l01226"></a>01226         Td1[(t1 &gt;&gt; 16) &amp; 0xff] ^
<a name="l01227"></a>01227         Td2[(t0 &gt;&gt;  8) &amp; 0xff] ^
<a name="l01228"></a>01228         Td3[(t3      ) &amp; 0xff] ^
<a name="l01229"></a>01229         rk[2];
<a name="l01230"></a>01230       s3 =
<a name="l01231"></a>01231         Td0[(t3 &gt;&gt; 24)       ] ^
<a name="l01232"></a>01232         Td1[(t2 &gt;&gt; 16) &amp; 0xff] ^
<a name="l01233"></a>01233         Td2[(t1 &gt;&gt;  8) &amp; 0xff] ^
<a name="l01234"></a>01234         Td3[(t0      ) &amp; 0xff] ^
<a name="l01235"></a>01235         rk[3];
<a name="l01236"></a>01236     }
<a name="l01237"></a>01237 <span class="preprocessor">  #endif </span><span class="comment">/* ?FULL_UNROLL */</span>
<a name="l01238"></a>01238   <span class="comment">/*</span>
<a name="l01239"></a>01239 <span class="comment">  * apply last round and</span>
<a name="l01240"></a>01240 <span class="comment">  * map cipher state to byte array block:</span>
<a name="l01241"></a>01241 <span class="comment">  */</span>
<a name="l01242"></a>01242   s0 =
<a name="l01243"></a>01243     (Td4[(t0 &gt;&gt; 24)       ] &amp; 0xff000000) ^
<a name="l01244"></a>01244     (Td4[(t3 &gt;&gt; 16) &amp; 0xff] &amp; 0x00ff0000) ^
<a name="l01245"></a>01245     (Td4[(t2 &gt;&gt;  8) &amp; 0xff] &amp; 0x0000ff00) ^
<a name="l01246"></a>01246     (Td4[(t1      ) &amp; 0xff] &amp; 0x000000ff) ^
<a name="l01247"></a>01247     rk[0];
<a name="l01248"></a>01248   PUTU32(plaintext     , s0);
<a name="l01249"></a>01249   s1 =
<a name="l01250"></a>01250     (Td4[(t1 &gt;&gt; 24)       ] &amp; 0xff000000) ^
<a name="l01251"></a>01251     (Td4[(t0 &gt;&gt; 16) &amp; 0xff] &amp; 0x00ff0000) ^
<a name="l01252"></a>01252     (Td4[(t3 &gt;&gt;  8) &amp; 0xff] &amp; 0x0000ff00) ^
<a name="l01253"></a>01253     (Td4[(t2      ) &amp; 0xff] &amp; 0x000000ff) ^
<a name="l01254"></a>01254     rk[1];
<a name="l01255"></a>01255   PUTU32(plaintext +  4, s1);
<a name="l01256"></a>01256   s2 =
<a name="l01257"></a>01257     (Td4[(t2 &gt;&gt; 24)       ] &amp; 0xff000000) ^
<a name="l01258"></a>01258     (Td4[(t1 &gt;&gt; 16) &amp; 0xff] &amp; 0x00ff0000) ^
<a name="l01259"></a>01259     (Td4[(t0 &gt;&gt;  8) &amp; 0xff] &amp; 0x0000ff00) ^
<a name="l01260"></a>01260     (Td4[(t3      ) &amp; 0xff] &amp; 0x000000ff) ^
<a name="l01261"></a>01261     rk[2];
<a name="l01262"></a>01262   PUTU32(plaintext +  8, s2);
<a name="l01263"></a>01263   s3 =
<a name="l01264"></a>01264     (Td4[(t3 &gt;&gt; 24)       ] &amp; 0xff000000) ^
<a name="l01265"></a>01265     (Td4[(t2 &gt;&gt; 16) &amp; 0xff] &amp; 0x00ff0000) ^
<a name="l01266"></a>01266     (Td4[(t1 &gt;&gt;  8) &amp; 0xff] &amp; 0x0000ff00) ^
<a name="l01267"></a>01267     (Td4[(t0      ) &amp; 0xff] &amp; 0x000000ff) ^
<a name="l01268"></a>01268     rk[3];
<a name="l01269"></a>01269   PUTU32(plaintext + 12, s3);
<a name="l01270"></a>01270 }
<a name="l01271"></a>01271 
<a name="l01272"></a>01272 <span class="preprocessor">#define KEYLENGTH(keybits) ((keybits)/8)</span>
<a name="l01273"></a>01273 <span class="preprocessor"></span><span class="preprocessor">#define RKLENGTH(keybits)  ((keybits)/8+28)</span>
<a name="l01274"></a>01274 <span class="preprocessor"></span><span class="preprocessor">#define NROUNDS(keybits)   ((keybits)/32+6)</span>
<a name="l01275"></a>01275 <span class="preprocessor"></span>
<a name="l01276"></a>01276 <span class="preprocessor">#define KEYBITS 128</span>
<a name="l01277"></a>01277 <span class="preprocessor"></span><span class="preprocessor">#define BLOCK_SIZE 16</span>
<a name="l01278"></a>01278 <span class="preprocessor"></span><span class="comment"></span>
<a name="l01279"></a>01279 <span class="comment">/**</span>
<a name="l01280"></a>01280 <span class="comment">  Ecrypt a block of data using AES.</span>
<a name="l01281"></a>01281 <span class="comment"></span>
<a name="l01282"></a>01282 <span class="comment">  @param output A pointer to the buffer into which the encrypted data will be written.</span>
<a name="l01283"></a>01283 <span class="comment">  @param outlen The maximum number of bytes to write into the output buffer.</span>
<a name="l01284"></a>01284 <span class="comment">  @param input A pointer to the data to be encrypted.</span>
<a name="l01285"></a>01285 <span class="comment">  @param inlen The number of bytes of data to encrypt.</span>
<a name="l01286"></a>01286 <span class="comment">  @param password The password, or key, used to encrypt the data.  Must be 16 bytes long.</span>
<a name="l01287"></a>01287 <span class="comment">  @return The number of bytes encrypted, or -1 on failure.</span>
<a name="l01288"></a>01288 <span class="comment"></span>
<a name="l01289"></a>01289 <span class="comment">  \par Example</span>
<a name="l01290"></a>01290 <span class="comment">  \code</span>
<a name="l01291"></a>01291 <span class="comment">  #define BUFF_SIZE 256</span>
<a name="l01292"></a>01292 <span class="comment">  unsigned char cipherbuf[BUFF_SIZE]; // the buffer that will be written into</span>
<a name="l01293"></a>01293 <span class="comment">  unsigned char plaintext[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"; // the text to encrypt</span>
<a name="l01294"></a>01294 <span class="comment">  unsigned char secret[] = "A SECRET PASSWORD"; // 16 bytes long</span>
<a name="l01295"></a>01295 <span class="comment">  int written = Aes_Encrypt(cipherbuf, BUFF_SIZE, plaintext, 26, secret);</span>
<a name="l01296"></a>01296 <span class="comment">  \endcode</span>
<a name="l01297"></a>01297 <span class="comment">*/</span>
<a name="l01298"></a><a class="code" href="group__aes.html#g8a6a56c97a2aba6b19962abf330ea266">01298</a> <span class="keywordtype">int</span> <a class="code" href="group__aes.html#g8a6a56c97a2aba6b19962abf330ea266" title="Ecrypt a block of data using AES.">Aes_Encrypt</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* output, <span class="keywordtype">int</span> outlen, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* input, <span class="keywordtype">int</span> inlen, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* password)
<a name="l01299"></a>01299 {
<a name="l01300"></a>01300   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> rk[RKLENGTH(KEYBITS)];
<a name="l01301"></a>01301   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> key[KEYLENGTH(KEYBITS)];
<a name="l01302"></a>01302   <span class="keywordtype">int</span> nrounds;
<a name="l01303"></a>01303   <span class="keywordtype">int</span> totalout = outlen;
<a name="l01304"></a>01304 
<a name="l01305"></a>01305   memcpy(key, password, BLOCK_SIZE); <span class="comment">// gotta be 16 coming in</span>
<a name="l01306"></a>01306 
<a name="l01307"></a>01307   nrounds = Aes_SetupEncrypt(rk, key, KEYBITS); <span class="comment">// initialize the encrypt buffer</span>
<a name="l01308"></a>01308   <span class="keywordflow">while</span>(inlen)
<a name="l01309"></a>01309   {
<a name="l01310"></a>01310     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> plaintext[BLOCK_SIZE];
<a name="l01311"></a>01311     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ciphertext[BLOCK_SIZE];
<a name="l01312"></a>01312     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j;
<a name="l01313"></a>01313     <span class="comment">// grab bytes from the input and stuff them in plaintext</span>
<a name="l01314"></a>01314     <span class="keywordflow">for</span>(j = 0; j &lt; BLOCK_SIZE; j++)
<a name="l01315"></a>01315     {
<a name="l01316"></a>01316       <span class="keywordflow">if</span>(inlen)
<a name="l01317"></a>01317       {
<a name="l01318"></a>01318         plaintext[j] = *input++;
<a name="l01319"></a>01319         inlen--;
<a name="l01320"></a>01320       }
<a name="l01321"></a>01321       <span class="keywordflow">else</span>
<a name="l01322"></a>01322         <span class="keywordflow">break</span>;
<a name="l01323"></a>01323     }
<a name="l01324"></a>01324 
<a name="l01325"></a>01325     <span class="keywordtype">char</span> c = BLOCK_SIZE - j; <span class="comment">// pad with the character that corresponds to how many bytes we need to pad</span>
<a name="l01326"></a>01326     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> orig_block_size = j;
<a name="l01327"></a>01327     <span class="keywordflow">for</span> (; j &lt; BLOCK_SIZE; j++) <span class="comment">// if we didn't get 16 bytes, pad plaintext</span>
<a name="l01328"></a>01328       plaintext[j] = c;
<a name="l01329"></a>01329     Aes_DoEncrypt(rk, nrounds, plaintext, ciphertext);
<a name="l01330"></a>01330     <span class="keywordflow">if</span>(outlen &lt; BLOCK_SIZE) <span class="comment">// not enough room to write out</span>
<a name="l01331"></a>01331       <span class="keywordflow">return</span> -1;
<a name="l01332"></a>01332     memcpy(output, ciphertext, BLOCK_SIZE);
<a name="l01333"></a>01333     output += BLOCK_SIZE;
<a name="l01334"></a>01334     outlen -= BLOCK_SIZE;
<a name="l01335"></a>01335 
<a name="l01336"></a>01336     <span class="keywordflow">if</span>(orig_block_size == BLOCK_SIZE &amp;&amp; inlen == 0) <span class="comment">// the last chunk was 16 bytes.  encrypt another round so we know how to decrypt the padding</span>
<a name="l01337"></a>01337     {
<a name="l01338"></a>01338       memset(plaintext, BLOCK_SIZE, BLOCK_SIZE); <span class="comment">// pad 16 bytes with the value 16</span>
<a name="l01339"></a>01339       Aes_DoEncrypt(rk, nrounds, plaintext, ciphertext);
<a name="l01340"></a>01340       <span class="keywordflow">if</span>(outlen &lt; BLOCK_SIZE) <span class="comment">// not enough room to write out</span>
<a name="l01341"></a>01341         <span class="keywordflow">return</span> -1;
<a name="l01342"></a>01342       memcpy(output, ciphertext, BLOCK_SIZE);
<a name="l01343"></a>01343       output += BLOCK_SIZE;
<a name="l01344"></a>01344       outlen -= BLOCK_SIZE;
<a name="l01345"></a>01345     }
<a name="l01346"></a>01346   }
<a name="l01347"></a>01347   <span class="keywordflow">return</span> totalout - outlen;
<a name="l01348"></a>01348 }
<a name="l01349"></a>01349 <span class="comment"></span>
<a name="l01350"></a>01350 <span class="comment">/**</span>
<a name="l01351"></a>01351 <span class="comment">  Decrypt a block of AES encrypted data.</span>
<a name="l01352"></a>01352 <span class="comment"></span>
<a name="l01353"></a>01353 <span class="comment">  @param output A pointer to the buffer into which the decrypted data will be written.</span>
<a name="l01354"></a>01354 <span class="comment">  @param outlen The maximum number of bytes of data to write into the output buffer.</span>
<a name="l01355"></a>01355 <span class="comment">  @param input A pointer to the encrypted block to be decrytped.</span>
<a name="l01356"></a>01356 <span class="comment">  @param inlen The number of bytes to be decrypted.</span>
<a name="l01357"></a>01357 <span class="comment">  @param password The password, or key, used to encrypt the data.  Must be 16 bytes long.</span>
<a name="l01358"></a>01358 <span class="comment">  @return The number of bytes written, or -1 on failure.</span>
<a name="l01359"></a>01359 <span class="comment"></span>
<a name="l01360"></a>01360 <span class="comment">  \par Example</span>
<a name="l01361"></a>01361 <span class="comment">  \code</span>
<a name="l01362"></a>01362 <span class="comment">  // first encrypt some data, then decrypt it and make sure we get out what we put in</span>
<a name="l01363"></a>01363 <span class="comment">  unsigned char cipherbuf[256];</span>
<a name="l01364"></a>01364 <span class="comment">  unsigned char plainbuf[256];</span>
<a name="l01365"></a>01365 <span class="comment">  unsigned char plaintext[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"; // our plaintext to encrypt</span>
<a name="l01366"></a>01366 <span class="comment">  unsigned char secret[] = "A SECRET PASSWORD"; // 16 bytes long</span>
<a name="l01367"></a>01367 <span class="comment"></span>
<a name="l01368"></a>01368 <span class="comment">  int written = Aes_Encrypt(cipherbuf, 256, plaintext, 26, secret);</span>
<a name="l01369"></a>01369 <span class="comment">  written = Aes_Decrypt(plainbuf, 256, cipherbuf, written, secret);</span>
<a name="l01370"></a>01370 <span class="comment">  // we now have our original plaintext in plainbuf</span>
<a name="l01371"></a>01371 <span class="comment">  \endcode</span>
<a name="l01372"></a>01372 <span class="comment">*/</span>
<a name="l01373"></a><a class="code" href="group__aes.html#g5c03c43f883600bc5877e9b50c54438a">01373</a> <span class="keywordtype">int</span> <a class="code" href="group__aes.html#g5c03c43f883600bc5877e9b50c54438a" title="Decrypt a block of AES encrypted data.">Aes_Decrypt</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* output, <span class="keywordtype">int</span> outlen, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* input, <span class="keywordtype">int</span> inlen, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* password)
<a name="l01374"></a>01374 {
<a name="l01375"></a>01375   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> rk[RKLENGTH(KEYBITS)];
<a name="l01376"></a>01376   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> key[KEYLENGTH(KEYBITS)];
<a name="l01377"></a>01377   <span class="keywordtype">int</span> nrounds;
<a name="l01378"></a>01378   <span class="keywordtype">int</span> totalout = outlen;
<a name="l01379"></a>01379 
<a name="l01380"></a>01380   memcpy(key, password, BLOCK_SIZE); <span class="comment">// gotta be 16 coming in</span>
<a name="l01381"></a>01381   
<a name="l01382"></a>01382   nrounds = Aes_SetupDecrypt(rk, key, KEYBITS);
<a name="l01383"></a>01383   <span class="keywordflow">while</span>(inlen)
<a name="l01384"></a>01384   {
<a name="l01385"></a>01385     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> plaintext[BLOCK_SIZE];
<a name="l01386"></a>01386     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ciphertext[BLOCK_SIZE];
<a name="l01387"></a>01387 
<a name="l01388"></a>01388     <span class="keywordflow">if</span>(inlen &lt; BLOCK_SIZE) <span class="comment">// the ciphered text should be in 16 byte chunks</span>
<a name="l01389"></a>01389       <span class="keywordflow">return</span> -1;
<a name="l01390"></a>01390     memcpy(ciphertext, input, BLOCK_SIZE); <span class="comment">// stuff a block from input in ciphertext</span>
<a name="l01391"></a>01391     input += BLOCK_SIZE;
<a name="l01392"></a>01392     inlen -= BLOCK_SIZE;
<a name="l01393"></a>01393     Aes_DoDecrypt(rk, nrounds, ciphertext, plaintext);
<a name="l01394"></a>01394     <span class="keywordflow">if</span>(inlen &lt; BLOCK_SIZE) <span class="comment">// we're on our last block.  check the padding to determine the size of the original data</span>
<a name="l01395"></a>01395     {
<a name="l01396"></a>01396       <span class="keywordtype">int</span> padlen = plaintext[BLOCK_SIZE-1]; <span class="comment">// look at the last byte</span>
<a name="l01397"></a>01397       <span class="keywordflow">if</span>(padlen &lt; 1 || padlen &gt; 16) <span class="comment">// check for bogus padlen</span>
<a name="l01398"></a>01398         <span class="keywordflow">return</span> -1;
<a name="l01399"></a>01399       <span class="keywordtype">int</span> datalen = BLOCK_SIZE - padlen;
<a name="l01400"></a>01400       <span class="keywordflow">if</span>(outlen &lt; datalen) <span class="comment">// not enough room to write out</span>
<a name="l01401"></a>01401         <span class="keywordflow">return</span> -1;
<a name="l01402"></a>01402       memcpy(output, plaintext, datalen); <span class="comment">// stuff only data (no padding) into the output</span>
<a name="l01403"></a>01403       outlen -= datalen;
<a name="l01404"></a>01404     }
<a name="l01405"></a>01405     <span class="keywordflow">else</span> <span class="comment">// proceed as normal</span>
<a name="l01406"></a>01406     {
<a name="l01407"></a>01407       <span class="keywordflow">if</span>(outlen &lt; BLOCK_SIZE) <span class="comment">// not enough room to write out</span>
<a name="l01408"></a>01408         <span class="keywordflow">return</span> -1;
<a name="l01409"></a>01409       memcpy(output, plaintext, BLOCK_SIZE); <span class="comment">// stuff a decrypted block into the output</span>
<a name="l01410"></a>01410       output += BLOCK_SIZE;
<a name="l01411"></a>01411       outlen -= BLOCK_SIZE;
<a name="l01412"></a>01412     }
<a name="l01413"></a>01413   }
<a name="l01414"></a>01414   <span class="keywordflow">return</span> totalout - outlen;
<a name="l01415"></a>01415 }
<a name="l01416"></a>01416 <span class="comment"></span>
<a name="l01417"></a>01417 <span class="comment">/** @}</span>
<a name="l01418"></a>01418 <span class="comment">*/</span>
<a name="l01419"></a>01419 
<a name="l01420"></a>01420 
<a name="l01421"></a>01421 
<a name="l01422"></a>01422 
<a name="l01423"></a>01423 
<a name="l01424"></a>01424 
</pre></div></div>

<hr size="1">
<div>
  <p id="footer">The Make Controller Kit is an open source project maintained by <a href="http://www.makingthings.com">MakingThings</a>.<br />
    MakingThings code is released under the <a href="http://www.apache.org/licenses/LICENSE-2.0.html" target="_blank">Apache 2.0 license</a>.<br />
    Bug tracker, development wiki and status can be found at <a href="http://dev.makingthings.com">http://dev.makingthings.com</a>.<br />
    This document was last updated on 18 May 2009.
  </p>
</div>
<!-- Google Analytics Code -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
_uacct = "UA-769030-1";
urchinTracker();
</script>
</body>
</html>
